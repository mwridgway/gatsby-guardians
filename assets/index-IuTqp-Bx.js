var Ai=Object.defineProperty;var Si=(t,n,e)=>n in t?Ai(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var v=(t,n,e)=>Si(t,typeof n!="symbol"?n+"":n,e);import{P as C,c as Se}from"./phaser-BhRZvspT.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();const Q=640,G=360,ki=600,Mn=100,Ei=-300,Ti=6,Mi=6,Pi=!0;/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Fi=4,Ht=0,Kt=1,Ii=2;function ve(t){let n=t.length;for(;--n>=0;)t[n]=0}const Ci=0,Pn=1,Oi=2,Di=3,Li=258,It=29,Ke=256,Ce=Ke+1+It,ge=30,Ct=19,Fn=2*Ce+1,oe=15,ot=16,Ri=7,Ot=256,In=16,Cn=17,On=18,xt=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),qe=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),zi=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Dn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bi=512,J=new Array((Ce+2)*2);ve(J);const Pe=new Array(ge*2);ve(Pe);const Oe=new Array(Bi);ve(Oe);const De=new Array(Li-Di+1);ve(De);const Dt=new Array(It);ve(Dt);const Qe=new Array(ge);ve(Qe);function lt(t,n,e,r,a){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=r,this.max_length=a,this.has_stree=t&&t.length}let Ln,Rn,zn;function ct(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}const Bn=t=>t<256?Oe[t]:Oe[256+(t>>>7)],Le=(t,n)=>{t.pending_buf[t.pending++]=n&255,t.pending_buf[t.pending++]=n>>>8&255},R=(t,n,e)=>{t.bi_valid>ot-e?(t.bi_buf|=n<<t.bi_valid&65535,Le(t,t.bi_buf),t.bi_buf=n>>ot-t.bi_valid,t.bi_valid+=e-ot):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},U=(t,n,e)=>{R(t,e[n*2],e[n*2+1])},Hn=(t,n)=>{let e=0;do e|=t&1,t>>>=1,e<<=1;while(--n>0);return e>>>1},Hi=t=>{t.bi_valid===16?(Le(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},Ki=(t,n)=>{const e=n.dyn_tree,r=n.max_code,a=n.stat_desc.static_tree,o=n.stat_desc.has_stree,c=n.stat_desc.extra_bits,d=n.stat_desc.extra_base,p=n.stat_desc.max_length;let f,h,i,s,l,u,g=0;for(s=0;s<=oe;s++)t.bl_count[s]=0;for(e[t.heap[t.heap_max]*2+1]=0,f=t.heap_max+1;f<Fn;f++)h=t.heap[f],s=e[e[h*2+1]*2+1]+1,s>p&&(s=p,g++),e[h*2+1]=s,!(h>r)&&(t.bl_count[s]++,l=0,h>=d&&(l=c[h-d]),u=e[h*2],t.opt_len+=u*(s+l),o&&(t.static_len+=u*(a[h*2+1]+l)));if(g!==0){do{for(s=p-1;t.bl_count[s]===0;)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[p]--,g-=2}while(g>0);for(s=p;s!==0;s--)for(h=t.bl_count[s];h!==0;)i=t.heap[--f],!(i>r)&&(e[i*2+1]!==s&&(t.opt_len+=(s-e[i*2+1])*e[i*2],e[i*2+1]=s),h--)}},Kn=(t,n,e)=>{const r=new Array(oe+1);let a=0,o,c;for(o=1;o<=oe;o++)a=a+e[o-1]<<1,r[o]=a;for(c=0;c<=n;c++){let d=t[c*2+1];d!==0&&(t[c*2]=Hn(r[d]++,d))}},Ni=()=>{let t,n,e,r,a;const o=new Array(oe+1);for(e=0,r=0;r<It-1;r++)for(Dt[r]=e,t=0;t<1<<xt[r];t++)De[e++]=r;for(De[e-1]=r,a=0,r=0;r<16;r++)for(Qe[r]=a,t=0;t<1<<qe[r];t++)Oe[a++]=r;for(a>>=7;r<ge;r++)for(Qe[r]=a<<7,t=0;t<1<<qe[r]-7;t++)Oe[256+a++]=r;for(n=0;n<=oe;n++)o[n]=0;for(t=0;t<=143;)J[t*2+1]=8,t++,o[8]++;for(;t<=255;)J[t*2+1]=9,t++,o[9]++;for(;t<=279;)J[t*2+1]=7,t++,o[7]++;for(;t<=287;)J[t*2+1]=8,t++,o[8]++;for(Kn(J,Ce+1,o),t=0;t<ge;t++)Pe[t*2+1]=5,Pe[t*2]=Hn(t,5);Ln=new lt(J,xt,Ke+1,Ce,oe),Rn=new lt(Pe,qe,0,ge,oe),zn=new lt(new Array(0),zi,0,Ct,Ri)},Nn=t=>{let n;for(n=0;n<Ce;n++)t.dyn_ltree[n*2]=0;for(n=0;n<ge;n++)t.dyn_dtree[n*2]=0;for(n=0;n<Ct;n++)t.bl_tree[n*2]=0;t.dyn_ltree[Ot*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Zn=t=>{t.bi_valid>8?Le(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Nt=(t,n,e,r)=>{const a=n*2,o=e*2;return t[a]<t[o]||t[a]===t[o]&&r[n]<=r[e]},ft=(t,n,e)=>{const r=t.heap[e];let a=e<<1;for(;a<=t.heap_len&&(a<t.heap_len&&Nt(n,t.heap[a+1],t.heap[a],t.depth)&&a++,!Nt(n,r,t.heap[a],t.depth));)t.heap[e]=t.heap[a],e=a,a<<=1;t.heap[e]=r},Zt=(t,n,e)=>{let r,a,o=0,c,d;if(t.sym_next!==0)do r=t.pending_buf[t.sym_buf+o++]&255,r+=(t.pending_buf[t.sym_buf+o++]&255)<<8,a=t.pending_buf[t.sym_buf+o++],r===0?U(t,a,n):(c=De[a],U(t,c+Ke+1,n),d=xt[c],d!==0&&(a-=Dt[c],R(t,a,d)),r--,c=Bn(r),U(t,c,e),d=qe[c],d!==0&&(r-=Qe[c],R(t,r,d)));while(o<t.sym_next);U(t,Ot,n)},At=(t,n)=>{const e=n.dyn_tree,r=n.stat_desc.static_tree,a=n.stat_desc.has_stree,o=n.stat_desc.elems;let c,d,p=-1,f;for(t.heap_len=0,t.heap_max=Fn,c=0;c<o;c++)e[c*2]!==0?(t.heap[++t.heap_len]=p=c,t.depth[c]=0):e[c*2+1]=0;for(;t.heap_len<2;)f=t.heap[++t.heap_len]=p<2?++p:0,e[f*2]=1,t.depth[f]=0,t.opt_len--,a&&(t.static_len-=r[f*2+1]);for(n.max_code=p,c=t.heap_len>>1;c>=1;c--)ft(t,e,c);f=o;do c=t.heap[1],t.heap[1]=t.heap[t.heap_len--],ft(t,e,1),d=t.heap[1],t.heap[--t.heap_max]=c,t.heap[--t.heap_max]=d,e[f*2]=e[c*2]+e[d*2],t.depth[f]=(t.depth[c]>=t.depth[d]?t.depth[c]:t.depth[d])+1,e[c*2+1]=e[d*2+1]=f,t.heap[1]=f++,ft(t,e,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],Ki(t,n),Kn(e,p,t.bl_count)},$t=(t,n,e)=>{let r,a=-1,o,c=n[0*2+1],d=0,p=7,f=4;for(c===0&&(p=138,f=3),n[(e+1)*2+1]=65535,r=0;r<=e;r++)o=c,c=n[(r+1)*2+1],!(++d<p&&o===c)&&(d<f?t.bl_tree[o*2]+=d:o!==0?(o!==a&&t.bl_tree[o*2]++,t.bl_tree[In*2]++):d<=10?t.bl_tree[Cn*2]++:t.bl_tree[On*2]++,d=0,a=o,c===0?(p=138,f=3):o===c?(p=6,f=3):(p=7,f=4))},Ut=(t,n,e)=>{let r,a=-1,o,c=n[0*2+1],d=0,p=7,f=4;for(c===0&&(p=138,f=3),r=0;r<=e;r++)if(o=c,c=n[(r+1)*2+1],!(++d<p&&o===c)){if(d<f)do U(t,o,t.bl_tree);while(--d!==0);else o!==0?(o!==a&&(U(t,o,t.bl_tree),d--),U(t,In,t.bl_tree),R(t,d-3,2)):d<=10?(U(t,Cn,t.bl_tree),R(t,d-3,3)):(U(t,On,t.bl_tree),R(t,d-11,7));d=0,a=o,c===0?(p=138,f=3):o===c?(p=6,f=3):(p=7,f=4)}},Zi=t=>{let n;for($t(t,t.dyn_ltree,t.l_desc.max_code),$t(t,t.dyn_dtree,t.d_desc.max_code),At(t,t.bl_desc),n=Ct-1;n>=3&&t.bl_tree[Dn[n]*2+1]===0;n--);return t.opt_len+=3*(n+1)+5+5+4,n},$i=(t,n,e,r)=>{let a;for(R(t,n-257,5),R(t,e-1,5),R(t,r-4,4),a=0;a<r;a++)R(t,t.bl_tree[Dn[a]*2+1],3);Ut(t,t.dyn_ltree,n-1),Ut(t,t.dyn_dtree,e-1)},Ui=t=>{let n=4093624447,e;for(e=0;e<=31;e++,n>>>=1)if(n&1&&t.dyn_ltree[e*2]!==0)return Ht;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return Kt;for(e=32;e<Ke;e++)if(t.dyn_ltree[e*2]!==0)return Kt;return Ht};let Gt=!1;const Gi=t=>{Gt||(Ni(),Gt=!0),t.l_desc=new ct(t.dyn_ltree,Ln),t.d_desc=new ct(t.dyn_dtree,Rn),t.bl_desc=new ct(t.bl_tree,zn),t.bi_buf=0,t.bi_valid=0,Nn(t)},$n=(t,n,e,r)=>{R(t,(Ci<<1)+(r?1:0),3),Zn(t),Le(t,e),Le(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e},Vi=t=>{R(t,Pn<<1,3),U(t,Ot,J),Hi(t)},Xi=(t,n,e,r)=>{let a,o,c=0;t.level>0?(t.strm.data_type===Ii&&(t.strm.data_type=Ui(t)),At(t,t.l_desc),At(t,t.d_desc),c=Zi(t),a=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=a&&(a=o)):a=o=e+5,e+4<=a&&n!==-1?$n(t,n,e,r):t.strategy===Fi||o===a?(R(t,(Pn<<1)+(r?1:0),3),Zt(t,J,Pe)):(R(t,(Oi<<1)+(r?1:0),3),$i(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),Zt(t,t.dyn_ltree,t.dyn_dtree)),Nn(t),r&&Zn(t)},Yi=(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,n===0?t.dyn_ltree[e*2]++:(t.matches++,n--,t.dyn_ltree[(De[e]+Ke+1)*2]++,t.dyn_dtree[Bn(n)*2]++),t.sym_next===t.sym_end);var Wi=Gi,ji=$n,Ji=Xi,qi=Yi,Qi=Vi,er={_tr_init:Wi,_tr_stored_block:ji,_tr_flush_block:Ji,_tr_tally:qi,_tr_align:Qi};const tr=(t,n,e,r)=>{let a=t&65535|0,o=t>>>16&65535|0,c=0;for(;e!==0;){c=e>2e3?2e3:e,e-=c;do a=a+n[r++]|0,o=o+a|0;while(--c);a%=65521,o%=65521}return a|o<<16|0};var Re=tr;const nr=()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;n[e]=t}return n},ir=new Uint32Array(nr()),rr=(t,n,e,r)=>{const a=ir,o=r+e;t^=-1;for(let c=r;c<o;c++)t=t>>>8^a[(t^n[c])&255];return t^-1};var O=rr,fe={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ne={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ar,_tr_stored_block:St,_tr_flush_block:sr,_tr_tally:ie,_tr_align:or}=er,{Z_NO_FLUSH:re,Z_PARTIAL_FLUSH:lr,Z_FULL_FLUSH:cr,Z_FINISH:K,Z_BLOCK:Vt,Z_OK:D,Z_STREAM_END:Xt,Z_STREAM_ERROR:V,Z_DATA_ERROR:fr,Z_BUF_ERROR:dt,Z_DEFAULT_COMPRESSION:dr,Z_FILTERED:ur,Z_HUFFMAN_ONLY:Ge,Z_RLE:hr,Z_FIXED:_r,Z_DEFAULT_STRATEGY:pr,Z_UNKNOWN:mr,Z_DEFLATED:it}=Ne,gr=9,wr=15,yr=8,vr=29,br=256,kt=br+1+vr,xr=30,Ar=19,Sr=2*kt+1,kr=15,T=3,ne=258,X=ne+T+1,Er=32,we=42,Lt=57,Et=69,Tt=73,Mt=91,Pt=103,le=113,Ee=666,L=1,be=2,de=3,xe=4,Tr=3,ce=(t,n)=>(t.msg=fe[n],n),Yt=t=>t*2-(t>4?9:0),te=t=>{let n=t.length;for(;--n>=0;)t[n]=0},Mr=t=>{let n,e,r,a=t.w_size;n=t.hash_size,r=n;do e=t.head[--r],t.head[r]=e>=a?e-a:0;while(--n);n=a,r=n;do e=t.prev[--r],t.prev[r]=e>=a?e-a:0;while(--n)};let Pr=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask,ae=Pr;const z=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),e!==0&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,n.pending===0&&(n.pending_out=0))},H=(t,n)=>{sr(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,z(t.strm)},P=(t,n)=>{t.pending_buf[t.pending++]=n},ke=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=n&255},Ft=(t,n,e,r)=>{let a=t.avail_in;return a>r&&(a=r),a===0?0:(t.avail_in-=a,n.set(t.input.subarray(t.next_in,t.next_in+a),e),t.state.wrap===1?t.adler=Re(t.adler,n,a,e):t.state.wrap===2&&(t.adler=O(t.adler,n,a,e)),t.next_in+=a,t.total_in+=a,a)},Un=(t,n)=>{let e=t.max_chain_length,r=t.strstart,a,o,c=t.prev_length,d=t.nice_match;const p=t.strstart>t.w_size-X?t.strstart-(t.w_size-X):0,f=t.window,h=t.w_mask,i=t.prev,s=t.strstart+ne;let l=f[r+c-1],u=f[r+c];t.prev_length>=t.good_match&&(e>>=2),d>t.lookahead&&(d=t.lookahead);do if(a=n,!(f[a+c]!==u||f[a+c-1]!==l||f[a]!==f[r]||f[++a]!==f[r+1])){r+=2,a++;do;while(f[++r]===f[++a]&&f[++r]===f[++a]&&f[++r]===f[++a]&&f[++r]===f[++a]&&f[++r]===f[++a]&&f[++r]===f[++a]&&f[++r]===f[++a]&&f[++r]===f[++a]&&r<s);if(o=ne-(s-r),r=s-ne,o>c){if(t.match_start=n,c=o,o>=d)break;l=f[r+c-1],u=f[r+c]}}while((n=i[n&h])>p&&--e!==0);return c<=t.lookahead?c:t.lookahead},ye=t=>{const n=t.w_size;let e,r,a;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-X)&&(t.window.set(t.window.subarray(n,n+n-r),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),Mr(t),r+=n),t.strm.avail_in===0)break;if(e=Ft(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=e,t.lookahead+t.insert>=T)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=ae(t,t.ins_h,t.window[a+1]);t.insert&&(t.ins_h=ae(t,t.ins_h,t.window[a+T-1]),t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<T)););}while(t.lookahead<X&&t.strm.avail_in!==0)},Gn=(t,n)=>{let e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,r,a,o,c=0,d=t.strm.avail_in;do{if(r=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,a=t.strstart-t.block_start,r>a+t.strm.avail_in&&(r=a+t.strm.avail_in),r>o&&(r=o),r<e&&(r===0&&n!==K||n===re||r!==a+t.strm.avail_in)))break;c=n===K&&r===a+t.strm.avail_in?1:0,St(t,0,0,c),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,z(t.strm),a&&(a>r&&(a=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+a),t.strm.next_out),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a,t.block_start+=a,r-=a),r&&(Ft(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(c===0);return d-=t.strm.avail_in,d&&(d>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=d&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-d,t.strm.next_in),t.strstart),t.strstart+=d,t.insert+=d>t.w_size-t.insert?t.w_size-t.insert:d),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),c?xe:n!==re&&n!==K&&t.strm.avail_in===0&&t.strstart===t.block_start?be:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(Ft(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,a=t.strstart-t.block_start,(a>=e||(a||n===K)&&n!==re&&t.strm.avail_in===0&&a<=o)&&(r=a>o?o:a,c=n===K&&t.strm.avail_in===0&&r===a?1:0,St(t,t.block_start,r,c),t.block_start+=r,z(t.strm)),c?de:L)},ut=(t,n)=>{let e,r;for(;;){if(t.lookahead<X){if(ye(t),t.lookahead<X&&n===re)return L;if(t.lookahead===0)break}if(e=0,t.lookahead>=T&&(t.ins_h=ae(t,t.ins_h,t.window[t.strstart+T-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),e!==0&&t.strstart-e<=t.w_size-X&&(t.match_length=Un(t,e)),t.match_length>=T)if(r=ie(t,t.strstart-t.match_start,t.match_length-T),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=T){t.match_length--;do t.strstart++,t.ins_h=ae(t,t.ins_h,t.window[t.strstart+T-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ae(t,t.ins_h,t.window[t.strstart+1]);else r=ie(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(H(t,!1),t.strm.avail_out===0))return L}return t.insert=t.strstart<T-1?t.strstart:T-1,n===K?(H(t,!0),t.strm.avail_out===0?de:xe):t.sym_next&&(H(t,!1),t.strm.avail_out===0)?L:be},pe=(t,n)=>{let e,r,a;for(;;){if(t.lookahead<X){if(ye(t),t.lookahead<X&&n===re)return L;if(t.lookahead===0)break}if(e=0,t.lookahead>=T&&(t.ins_h=ae(t,t.ins_h,t.window[t.strstart+T-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=T-1,e!==0&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-X&&(t.match_length=Un(t,e),t.match_length<=5&&(t.strategy===ur||t.match_length===T&&t.strstart-t.match_start>4096)&&(t.match_length=T-1)),t.prev_length>=T&&t.match_length<=t.prev_length){a=t.strstart+t.lookahead-T,r=ie(t,t.strstart-1-t.prev_match,t.prev_length-T),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=a&&(t.ins_h=ae(t,t.ins_h,t.window[t.strstart+T-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=T-1,t.strstart++,r&&(H(t,!1),t.strm.avail_out===0))return L}else if(t.match_available){if(r=ie(t,0,t.window[t.strstart-1]),r&&H(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return L}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=ie(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<T-1?t.strstart:T-1,n===K?(H(t,!0),t.strm.avail_out===0?de:xe):t.sym_next&&(H(t,!1),t.strm.avail_out===0)?L:be},Fr=(t,n)=>{let e,r,a,o;const c=t.window;for(;;){if(t.lookahead<=ne){if(ye(t),t.lookahead<=ne&&n===re)return L;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=T&&t.strstart>0&&(a=t.strstart-1,r=c[a],r===c[++a]&&r===c[++a]&&r===c[++a])){o=t.strstart+ne;do;while(r===c[++a]&&r===c[++a]&&r===c[++a]&&r===c[++a]&&r===c[++a]&&r===c[++a]&&r===c[++a]&&r===c[++a]&&a<o);t.match_length=ne-(o-a),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=T?(e=ie(t,1,t.match_length-T),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=ie(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(H(t,!1),t.strm.avail_out===0))return L}return t.insert=0,n===K?(H(t,!0),t.strm.avail_out===0?de:xe):t.sym_next&&(H(t,!1),t.strm.avail_out===0)?L:be},Ir=(t,n)=>{let e;for(;;){if(t.lookahead===0&&(ye(t),t.lookahead===0)){if(n===re)return L;break}if(t.match_length=0,e=ie(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(H(t,!1),t.strm.avail_out===0))return L}return t.insert=0,n===K?(H(t,!0),t.strm.avail_out===0?de:xe):t.sym_next&&(H(t,!1),t.strm.avail_out===0)?L:be};function $(t,n,e,r,a){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=r,this.func=a}const Te=[new $(0,0,0,0,Gn),new $(4,4,8,4,ut),new $(4,5,16,8,ut),new $(4,6,32,32,ut),new $(4,4,16,16,pe),new $(8,16,32,32,pe),new $(8,16,128,128,pe),new $(8,32,128,256,pe),new $(32,128,258,1024,pe),new $(32,258,258,4096,pe)],Cr=t=>{t.window_size=2*t.w_size,te(t.head),t.max_lazy_match=Te[t.level].max_lazy,t.good_match=Te[t.level].good_length,t.nice_match=Te[t.level].nice_length,t.max_chain_length=Te[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=T-1,t.match_available=0,t.ins_h=0};function Or(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=it,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Sr*2),this.dyn_dtree=new Uint16Array((2*xr+1)*2),this.bl_tree=new Uint16Array((2*Ar+1)*2),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(kr+1),this.heap=new Uint16Array(2*kt+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*kt+1),te(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ze=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.status!==we&&n.status!==Lt&&n.status!==Et&&n.status!==Tt&&n.status!==Mt&&n.status!==Pt&&n.status!==le&&n.status!==Ee?1:0},Vn=t=>{if(Ze(t))return ce(t,V);t.total_in=t.total_out=0,t.data_type=mr;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?Lt:n.wrap?we:le,t.adler=n.wrap===2?0:1,n.last_flush=-2,ar(n),D},Xn=t=>{const n=Vn(t);return n===D&&Cr(t.state),n},Dr=(t,n)=>Ze(t)||t.state.wrap!==2?V:(t.state.gzhead=n,D),Yn=(t,n,e,r,a,o)=>{if(!t)return V;let c=1;if(n===dr&&(n=6),r<0?(c=0,r=-r):r>15&&(c=2,r-=16),a<1||a>gr||e!==it||r<8||r>15||n<0||n>9||o<0||o>_r||r===8&&c!==1)return ce(t,V);r===8&&(r=9);const d=new Or;return t.state=d,d.strm=t,d.status=we,d.wrap=c,d.gzhead=null,d.w_bits=r,d.w_size=1<<d.w_bits,d.w_mask=d.w_size-1,d.hash_bits=a+7,d.hash_size=1<<d.hash_bits,d.hash_mask=d.hash_size-1,d.hash_shift=~~((d.hash_bits+T-1)/T),d.window=new Uint8Array(d.w_size*2),d.head=new Uint16Array(d.hash_size),d.prev=new Uint16Array(d.w_size),d.lit_bufsize=1<<a+6,d.pending_buf_size=d.lit_bufsize*4,d.pending_buf=new Uint8Array(d.pending_buf_size),d.sym_buf=d.lit_bufsize,d.sym_end=(d.lit_bufsize-1)*3,d.level=n,d.strategy=o,d.method=e,Xn(t)},Lr=(t,n)=>Yn(t,n,it,wr,yr,pr),Rr=(t,n)=>{if(Ze(t)||n>Vt||n<0)return t?ce(t,V):V;const e=t.state;if(!t.output||t.avail_in!==0&&!t.input||e.status===Ee&&n!==K)return ce(t,t.avail_out===0?dt:V);const r=e.last_flush;if(e.last_flush=n,e.pending!==0){if(z(t),t.avail_out===0)return e.last_flush=-1,D}else if(t.avail_in===0&&Yt(n)<=Yt(r)&&n!==K)return ce(t,dt);if(e.status===Ee&&t.avail_in!==0)return ce(t,dt);if(e.status===we&&e.wrap===0&&(e.status=le),e.status===we){let a=it+(e.w_bits-8<<4)<<8,o=-1;if(e.strategy>=Ge||e.level<2?o=0:e.level<6?o=1:e.level===6?o=2:o=3,a|=o<<6,e.strstart!==0&&(a|=Er),a+=31-a%31,ke(e,a),e.strstart!==0&&(ke(e,t.adler>>>16),ke(e,t.adler&65535)),t.adler=1,e.status=le,z(t),e.pending!==0)return e.last_flush=-1,D}if(e.status===Lt){if(t.adler=0,P(e,31),P(e,139),P(e,8),e.gzhead)P(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),P(e,e.gzhead.time&255),P(e,e.gzhead.time>>8&255),P(e,e.gzhead.time>>16&255),P(e,e.gzhead.time>>24&255),P(e,e.level===9?2:e.strategy>=Ge||e.level<2?4:0),P(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(P(e,e.gzhead.extra.length&255),P(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=O(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=Et;else if(P(e,0),P(e,0),P(e,0),P(e,0),P(e,0),P(e,e.level===9?2:e.strategy>=Ge||e.level<2?4:0),P(e,Tr),e.status=le,z(t),e.pending!==0)return e.last_flush=-1,D}if(e.status===Et){if(e.gzhead.extra){let a=e.pending,o=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let d=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+d),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>a&&(t.adler=O(t.adler,e.pending_buf,e.pending-a,a)),e.gzindex+=d,z(t),e.pending!==0)return e.last_flush=-1,D;a=0,o-=d}let c=new Uint8Array(e.gzhead.extra);e.pending_buf.set(c.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>a&&(t.adler=O(t.adler,e.pending_buf,e.pending-a,a)),e.gzindex=0}e.status=Tt}if(e.status===Tt){if(e.gzhead.name){let a=e.pending,o;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(t.adler=O(t.adler,e.pending_buf,e.pending-a,a)),z(t),e.pending!==0)return e.last_flush=-1,D;a=0}e.gzindex<e.gzhead.name.length?o=e.gzhead.name.charCodeAt(e.gzindex++)&255:o=0,P(e,o)}while(o!==0);e.gzhead.hcrc&&e.pending>a&&(t.adler=O(t.adler,e.pending_buf,e.pending-a,a)),e.gzindex=0}e.status=Mt}if(e.status===Mt){if(e.gzhead.comment){let a=e.pending,o;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(t.adler=O(t.adler,e.pending_buf,e.pending-a,a)),z(t),e.pending!==0)return e.last_flush=-1,D;a=0}e.gzindex<e.gzhead.comment.length?o=e.gzhead.comment.charCodeAt(e.gzindex++)&255:o=0,P(e,o)}while(o!==0);e.gzhead.hcrc&&e.pending>a&&(t.adler=O(t.adler,e.pending_buf,e.pending-a,a))}e.status=Pt}if(e.status===Pt){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(z(t),e.pending!==0))return e.last_flush=-1,D;P(e,t.adler&255),P(e,t.adler>>8&255),t.adler=0}if(e.status=le,z(t),e.pending!==0)return e.last_flush=-1,D}if(t.avail_in!==0||e.lookahead!==0||n!==re&&e.status!==Ee){let a=e.level===0?Gn(e,n):e.strategy===Ge?Ir(e,n):e.strategy===hr?Fr(e,n):Te[e.level].func(e,n);if((a===de||a===xe)&&(e.status=Ee),a===L||a===de)return t.avail_out===0&&(e.last_flush=-1),D;if(a===be&&(n===lr?or(e):n!==Vt&&(St(e,0,0,!1),n===cr&&(te(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),z(t),t.avail_out===0))return e.last_flush=-1,D}return n!==K?D:e.wrap<=0?Xt:(e.wrap===2?(P(e,t.adler&255),P(e,t.adler>>8&255),P(e,t.adler>>16&255),P(e,t.adler>>24&255),P(e,t.total_in&255),P(e,t.total_in>>8&255),P(e,t.total_in>>16&255),P(e,t.total_in>>24&255)):(ke(e,t.adler>>>16),ke(e,t.adler&65535)),z(t),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?D:Xt)},zr=t=>{if(Ze(t))return V;const n=t.state.status;return t.state=null,n===le?ce(t,fr):D},Br=(t,n)=>{let e=n.length;if(Ze(t))return V;const r=t.state,a=r.wrap;if(a===2||a===1&&r.status!==we||r.lookahead)return V;if(a===1&&(t.adler=Re(t.adler,n,e,0)),r.wrap=0,e>=r.w_size){a===0&&(te(r.head),r.strstart=0,r.block_start=0,r.insert=0);let p=new Uint8Array(r.w_size);p.set(n.subarray(e-r.w_size,e),0),n=p,e=r.w_size}const o=t.avail_in,c=t.next_in,d=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,ye(r);r.lookahead>=T;){let p=r.strstart,f=r.lookahead-(T-1);do r.ins_h=ae(r,r.ins_h,r.window[p+T-1]),r.prev[p&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=p,p++;while(--f);r.strstart=p,r.lookahead=T-1,ye(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=T-1,r.match_available=0,t.next_in=c,t.input=d,t.avail_in=o,r.wrap=a,D};var Hr=Lr,Kr=Yn,Nr=Xn,Zr=Vn,$r=Dr,Ur=Rr,Gr=zr,Vr=Br,Xr="pako deflate (from Nodeca project)",Fe={deflateInit:Hr,deflateInit2:Kr,deflateReset:Nr,deflateResetKeep:Zr,deflateSetHeader:$r,deflate:Ur,deflateEnd:Gr,deflateSetDictionary:Vr,deflateInfo:Xr};const Yr=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var Wr=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const r in e)Yr(e,r)&&(t[r]=e[r])}}return t},jr=t=>{let n=0;for(let r=0,a=t.length;r<a;r++)n+=t[r].length;const e=new Uint8Array(n);for(let r=0,a=0,o=t.length;r<o;r++){let c=t[r];e.set(c,a),a+=c.length}return e},rt={assign:Wr,flattenChunks:jr};let Wn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Wn=!1}const ze=new Uint8Array(256);for(let t=0;t<256;t++)ze[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ze[254]=ze[254]=1;var Jr=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let n,e,r,a,o,c=t.length,d=0;for(a=0;a<c;a++)e=t.charCodeAt(a),(e&64512)===55296&&a+1<c&&(r=t.charCodeAt(a+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),a++)),d+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(d),o=0,a=0;o<d;a++)e=t.charCodeAt(a),(e&64512)===55296&&a+1<c&&(r=t.charCodeAt(a+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),a++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|e&63):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|e&63):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|e&63);return n};const qr=(t,n)=>{if(n<65534&&t.subarray&&Wn)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let r=0;r<n;r++)e+=String.fromCharCode(t[r]);return e};var Qr=(t,n)=>{const e=n||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,n));let r,a;const o=new Array(e*2);for(a=0,r=0;r<e;){let c=t[r++];if(c<128){o[a++]=c;continue}let d=ze[c];if(d>4){o[a++]=65533,r+=d-1;continue}for(c&=d===2?31:d===3?15:7;d>1&&r<e;)c=c<<6|t[r++]&63,d--;if(d>1){o[a++]=65533;continue}c<65536?o[a++]=c:(c-=65536,o[a++]=55296|c>>10&1023,o[a++]=56320|c&1023)}return qr(o,a)},ea=(t,n)=>{n=n||t.length,n>t.length&&(n=t.length);let e=n-1;for(;e>=0&&(t[e]&192)===128;)e--;return e<0||e===0?n:e+ze[t[e]]>n?e:n},Be={string2buf:Jr,buf2string:Qr,utf8border:ea};function ta(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var jn=ta;const Jn=Object.prototype.toString,{Z_NO_FLUSH:na,Z_SYNC_FLUSH:ia,Z_FULL_FLUSH:ra,Z_FINISH:aa,Z_OK:et,Z_STREAM_END:sa,Z_DEFAULT_COMPRESSION:oa,Z_DEFAULT_STRATEGY:la,Z_DEFLATED:ca}=Ne;function $e(t){this.options=rt.assign({level:oa,method:ca,chunkSize:16384,windowBits:15,memLevel:8,strategy:la},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jn,this.strm.avail_out=0;let e=Fe.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==et)throw new Error(fe[e]);if(n.header&&Fe.deflateSetHeader(this.strm,n.header),n.dictionary){let r;if(typeof n.dictionary=="string"?r=Be.string2buf(n.dictionary):Jn.call(n.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(n.dictionary):r=n.dictionary,e=Fe.deflateSetDictionary(this.strm,r),e!==et)throw new Error(fe[e]);this._dict_set=!0}}$e.prototype.push=function(t,n){const e=this.strm,r=this.options.chunkSize;let a,o;if(this.ended)return!1;for(n===~~n?o=n:o=n===!0?aa:na,typeof t=="string"?e.input=Be.string2buf(t):Jn.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),(o===ia||o===ra)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(a=Fe.deflate(e,o),a===sa)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),a=Fe.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===et;if(e.avail_out===0){this.onData(e.output);continue}if(o>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};$e.prototype.onData=function(t){this.chunks.push(t)};$e.prototype.onEnd=function(t){t===et&&(this.result=rt.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Rt(t,n){const e=new $e(n);if(e.push(t,!0),e.err)throw e.msg||fe[e.err];return e.result}function fa(t,n){return n=n||{},n.raw=!0,Rt(t,n)}function da(t,n){return n=n||{},n.gzip=!0,Rt(t,n)}var ua=$e,ha=Rt,_a=fa,pa=da,ma={Deflate:ua,deflate:ha,deflateRaw:_a,gzip:pa};const Ve=16209,ga=16191;var wa=function(n,e){let r,a,o,c,d,p,f,h,i,s,l,u,g,m,_,y,b,w,k,F,A,M,x,S;const E=n.state;r=n.next_in,x=n.input,a=r+(n.avail_in-5),o=n.next_out,S=n.output,c=o-(e-n.avail_out),d=o+(n.avail_out-257),p=E.dmax,f=E.wsize,h=E.whave,i=E.wnext,s=E.window,l=E.hold,u=E.bits,g=E.lencode,m=E.distcode,_=(1<<E.lenbits)-1,y=(1<<E.distbits)-1;e:do{u<15&&(l+=x[r++]<<u,u+=8,l+=x[r++]<<u,u+=8),b=g[l&_];t:for(;;){if(w=b>>>24,l>>>=w,u-=w,w=b>>>16&255,w===0)S[o++]=b&65535;else if(w&16){k=b&65535,w&=15,w&&(u<w&&(l+=x[r++]<<u,u+=8),k+=l&(1<<w)-1,l>>>=w,u-=w),u<15&&(l+=x[r++]<<u,u+=8,l+=x[r++]<<u,u+=8),b=m[l&y];n:for(;;){if(w=b>>>24,l>>>=w,u-=w,w=b>>>16&255,w&16){if(F=b&65535,w&=15,u<w&&(l+=x[r++]<<u,u+=8,u<w&&(l+=x[r++]<<u,u+=8)),F+=l&(1<<w)-1,F>p){n.msg="invalid distance too far back",E.mode=Ve;break e}if(l>>>=w,u-=w,w=o-c,F>w){if(w=F-w,w>h&&E.sane){n.msg="invalid distance too far back",E.mode=Ve;break e}if(A=0,M=s,i===0){if(A+=f-w,w<k){k-=w;do S[o++]=s[A++];while(--w);A=o-F,M=S}}else if(i<w){if(A+=f+i-w,w-=i,w<k){k-=w;do S[o++]=s[A++];while(--w);if(A=0,i<k){w=i,k-=w;do S[o++]=s[A++];while(--w);A=o-F,M=S}}}else if(A+=i-w,w<k){k-=w;do S[o++]=s[A++];while(--w);A=o-F,M=S}for(;k>2;)S[o++]=M[A++],S[o++]=M[A++],S[o++]=M[A++],k-=3;k&&(S[o++]=M[A++],k>1&&(S[o++]=M[A++]))}else{A=o-F;do S[o++]=S[A++],S[o++]=S[A++],S[o++]=S[A++],k-=3;while(k>2);k&&(S[o++]=S[A++],k>1&&(S[o++]=S[A++]))}}else if(w&64){n.msg="invalid distance code",E.mode=Ve;break e}else{b=m[(b&65535)+(l&(1<<w)-1)];continue n}break}}else if(w&64)if(w&32){E.mode=ga;break e}else{n.msg="invalid literal/length code",E.mode=Ve;break e}else{b=g[(b&65535)+(l&(1<<w)-1)];continue t}break}}while(r<a&&o<d);k=u>>3,r-=k,u-=k<<3,l&=(1<<u)-1,n.next_in=r,n.next_out=o,n.avail_in=r<a?5+(a-r):5-(r-a),n.avail_out=o<d?257+(d-o):257-(o-d),E.hold=l,E.bits=u};const me=15,Wt=852,jt=592,Jt=0,ht=1,qt=2,ya=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),va=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ba=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xa=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Aa=(t,n,e,r,a,o,c,d)=>{const p=d.bits;let f=0,h=0,i=0,s=0,l=0,u=0,g=0,m=0,_=0,y=0,b,w,k,F,A,M=null,x;const S=new Uint16Array(me+1),E=new Uint16Array(me+1);let Y=null,Ae,Z,_e;for(f=0;f<=me;f++)S[f]=0;for(h=0;h<r;h++)S[n[e+h]]++;for(l=p,s=me;s>=1&&S[s]===0;s--);if(l>s&&(l=s),s===0)return a[o++]=1<<24|64<<16|0,a[o++]=1<<24|64<<16|0,d.bits=1,0;for(i=1;i<s&&S[i]===0;i++);for(l<i&&(l=i),m=1,f=1;f<=me;f++)if(m<<=1,m-=S[f],m<0)return-1;if(m>0&&(t===Jt||s!==1))return-1;for(E[1]=0,f=1;f<me;f++)E[f+1]=E[f]+S[f];for(h=0;h<r;h++)n[e+h]!==0&&(c[E[n[e+h]]++]=h);if(t===Jt?(M=Y=c,x=20):t===ht?(M=ya,Y=va,x=257):(M=ba,Y=xa,x=0),y=0,h=0,f=i,A=o,u=l,g=0,k=-1,_=1<<l,F=_-1,t===ht&&_>Wt||t===qt&&_>jt)return 1;for(;;){Ae=f-g,c[h]+1<x?(Z=0,_e=c[h]):c[h]>=x?(Z=Y[c[h]-x],_e=M[c[h]-x]):(Z=96,_e=0),b=1<<f-g,w=1<<u,i=w;do w-=b,a[A+(y>>g)+w]=Ae<<24|Z<<16|_e|0;while(w!==0);for(b=1<<f-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,h++,--S[f]===0){if(f===s)break;f=n[e+c[h]]}if(f>l&&(y&F)!==k){for(g===0&&(g=l),A+=i,u=f-g,m=1<<u;u+g<s&&(m-=S[u+g],!(m<=0));)u++,m<<=1;if(_+=1<<u,t===ht&&_>Wt||t===qt&&_>jt)return 1;k=y&F,a[k]=l<<24|u<<16|A-o|0}}return y!==0&&(a[A+y]=f-g<<24|64<<16|0),d.bits=l,0};var Ie=Aa;const Sa=0,qn=1,Qn=2,{Z_FINISH:Qt,Z_BLOCK:ka,Z_TREES:Xe,Z_OK:ue,Z_STREAM_END:Ea,Z_NEED_DICT:Ta,Z_STREAM_ERROR:N,Z_DATA_ERROR:ei,Z_MEM_ERROR:ti,Z_BUF_ERROR:Ma,Z_DEFLATED:en}=Ne,at=16180,tn=16181,nn=16182,rn=16183,an=16184,sn=16185,on=16186,ln=16187,cn=16188,fn=16189,tt=16190,W=16191,_t=16192,dn=16193,pt=16194,un=16195,hn=16196,_n=16197,pn=16198,Ye=16199,We=16200,mn=16201,gn=16202,wn=16203,yn=16204,vn=16205,mt=16206,bn=16207,xn=16208,I=16209,ni=16210,ii=16211,Pa=852,Fa=592,Ia=15,Ca=Ia,An=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Oa(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const he=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<at||n.mode>ii?1:0},ri=t=>{if(he(t))return N;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=n.wrap&1),n.mode=at,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(Pa),n.distcode=n.distdyn=new Int32Array(Fa),n.sane=1,n.back=-1,ue},ai=t=>{if(he(t))return N;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,ri(t)},si=(t,n)=>{let e;if(he(t))return N;const r=t.state;return n<0?(e=0,n=-n):(e=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?N:(r.window!==null&&r.wbits!==n&&(r.window=null),r.wrap=e,r.wbits=n,ai(t))},oi=(t,n)=>{if(!t)return N;const e=new Oa;t.state=e,e.strm=t,e.window=null,e.mode=at;const r=si(t,n);return r!==ue&&(t.state=null),r},Da=t=>oi(t,Ca);let Sn=!0,gt,wt;const La=t=>{if(Sn){gt=new Int32Array(512),wt=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(Ie(qn,t.lens,0,288,gt,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;Ie(Qn,t.lens,0,32,wt,0,t.work,{bits:5}),Sn=!1}t.lencode=gt,t.lenbits=9,t.distcode=wt,t.distbits=5},li=(t,n,e,r)=>{let a;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(a=o.wsize-o.wnext,a>r&&(a=r),o.window.set(n.subarray(e-r,e-r+a),o.wnext),r-=a,r?(o.window.set(n.subarray(e-r,e),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0},Ra=(t,n)=>{let e,r,a,o,c,d,p,f,h,i,s,l,u,g,m=0,_,y,b,w,k,F,A,M;const x=new Uint8Array(4);let S,E;const Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(he(t)||!t.output||!t.input&&t.avail_in!==0)return N;e=t.state,e.mode===W&&(e.mode=_t),c=t.next_out,a=t.output,p=t.avail_out,o=t.next_in,r=t.input,d=t.avail_in,f=e.hold,h=e.bits,i=d,s=p,M=ue;e:for(;;)switch(e.mode){case at:if(e.wrap===0){e.mode=_t;break}for(;h<16;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(e.wrap&2&&f===35615){e.wbits===0&&(e.wbits=15),e.check=0,x[0]=f&255,x[1]=f>>>8&255,e.check=O(e.check,x,2,0),f=0,h=0,e.mode=tn;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check",e.mode=I;break}if((f&15)!==en){t.msg="unknown compression method",e.mode=I;break}if(f>>>=4,h-=4,A=(f&15)+8,e.wbits===0&&(e.wbits=A),A>15||A>e.wbits){t.msg="invalid window size",e.mode=I;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=f&512?fn:W,f=0,h=0;break;case tn:for(;h<16;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(e.flags=f,(e.flags&255)!==en){t.msg="unknown compression method",e.mode=I;break}if(e.flags&57344){t.msg="unknown header flags set",e.mode=I;break}e.head&&(e.head.text=f>>8&1),e.flags&512&&e.wrap&4&&(x[0]=f&255,x[1]=f>>>8&255,e.check=O(e.check,x,2,0)),f=0,h=0,e.mode=nn;case nn:for(;h<32;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}e.head&&(e.head.time=f),e.flags&512&&e.wrap&4&&(x[0]=f&255,x[1]=f>>>8&255,x[2]=f>>>16&255,x[3]=f>>>24&255,e.check=O(e.check,x,4,0)),f=0,h=0,e.mode=rn;case rn:for(;h<16;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}e.head&&(e.head.xflags=f&255,e.head.os=f>>8),e.flags&512&&e.wrap&4&&(x[0]=f&255,x[1]=f>>>8&255,e.check=O(e.check,x,2,0)),f=0,h=0,e.mode=an;case an:if(e.flags&1024){for(;h<16;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}e.length=f,e.head&&(e.head.extra_len=f),e.flags&512&&e.wrap&4&&(x[0]=f&255,x[1]=f>>>8&255,e.check=O(e.check,x,2,0)),f=0,h=0}else e.head&&(e.head.extra=null);e.mode=sn;case sn:if(e.flags&1024&&(l=e.length,l>d&&(l=d),l&&(e.head&&(A=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(r.subarray(o,o+l),A)),e.flags&512&&e.wrap&4&&(e.check=O(e.check,r,l,o)),d-=l,o+=l,e.length-=l),e.length))break e;e.length=0,e.mode=on;case on:if(e.flags&2048){if(d===0)break e;l=0;do A=r[o+l++],e.head&&A&&e.length<65536&&(e.head.name+=String.fromCharCode(A));while(A&&l<d);if(e.flags&512&&e.wrap&4&&(e.check=O(e.check,r,l,o)),d-=l,o+=l,A)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=ln;case ln:if(e.flags&4096){if(d===0)break e;l=0;do A=r[o+l++],e.head&&A&&e.length<65536&&(e.head.comment+=String.fromCharCode(A));while(A&&l<d);if(e.flags&512&&e.wrap&4&&(e.check=O(e.check,r,l,o)),d-=l,o+=l,A)break e}else e.head&&(e.head.comment=null);e.mode=cn;case cn:if(e.flags&512){for(;h<16;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(e.wrap&4&&f!==(e.check&65535)){t.msg="header crc mismatch",e.mode=I;break}f=0,h=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=W;break;case fn:for(;h<32;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}t.adler=e.check=An(f),f=0,h=0,e.mode=tt;case tt:if(e.havedict===0)return t.next_out=c,t.avail_out=p,t.next_in=o,t.avail_in=d,e.hold=f,e.bits=h,Ta;t.adler=e.check=1,e.mode=W;case W:if(n===ka||n===Xe)break e;case _t:if(e.last){f>>>=h&7,h-=h&7,e.mode=mt;break}for(;h<3;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}switch(e.last=f&1,f>>>=1,h-=1,f&3){case 0:e.mode=dn;break;case 1:if(La(e),e.mode=Ye,n===Xe){f>>>=2,h-=2;break e}break;case 2:e.mode=hn;break;case 3:t.msg="invalid block type",e.mode=I}f>>>=2,h-=2;break;case dn:for(f>>>=h&7,h-=h&7;h<32;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths",e.mode=I;break}if(e.length=f&65535,f=0,h=0,e.mode=pt,n===Xe)break e;case pt:e.mode=un;case un:if(l=e.length,l){if(l>d&&(l=d),l>p&&(l=p),l===0)break e;a.set(r.subarray(o,o+l),c),d-=l,o+=l,p-=l,c+=l,e.length-=l;break}e.mode=W;break;case hn:for(;h<14;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(e.nlen=(f&31)+257,f>>>=5,h-=5,e.ndist=(f&31)+1,f>>>=5,h-=5,e.ncode=(f&15)+4,f>>>=4,h-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=I;break}e.have=0,e.mode=_n;case _n:for(;e.have<e.ncode;){for(;h<3;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}e.lens[Y[e.have++]]=f&7,f>>>=3,h-=3}for(;e.have<19;)e.lens[Y[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,S={bits:e.lenbits},M=Ie(Sa,e.lens,0,19,e.lencode,0,e.work,S),e.lenbits=S.bits,M){t.msg="invalid code lengths set",e.mode=I;break}e.have=0,e.mode=pn;case pn:for(;e.have<e.nlen+e.ndist;){for(;m=e.lencode[f&(1<<e.lenbits)-1],_=m>>>24,y=m>>>16&255,b=m&65535,!(_<=h);){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(b<16)f>>>=_,h-=_,e.lens[e.have++]=b;else{if(b===16){for(E=_+2;h<E;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(f>>>=_,h-=_,e.have===0){t.msg="invalid bit length repeat",e.mode=I;break}A=e.lens[e.have-1],l=3+(f&3),f>>>=2,h-=2}else if(b===17){for(E=_+3;h<E;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}f>>>=_,h-=_,A=0,l=3+(f&7),f>>>=3,h-=3}else{for(E=_+7;h<E;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}f>>>=_,h-=_,A=0,l=11+(f&127),f>>>=7,h-=7}if(e.have+l>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=I;break}for(;l--;)e.lens[e.have++]=A}}if(e.mode===I)break;if(e.lens[256]===0){t.msg="invalid code -- missing end-of-block",e.mode=I;break}if(e.lenbits=9,S={bits:e.lenbits},M=Ie(qn,e.lens,0,e.nlen,e.lencode,0,e.work,S),e.lenbits=S.bits,M){t.msg="invalid literal/lengths set",e.mode=I;break}if(e.distbits=6,e.distcode=e.distdyn,S={bits:e.distbits},M=Ie(Qn,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,S),e.distbits=S.bits,M){t.msg="invalid distances set",e.mode=I;break}if(e.mode=Ye,n===Xe)break e;case Ye:e.mode=We;case We:if(d>=6&&p>=258){t.next_out=c,t.avail_out=p,t.next_in=o,t.avail_in=d,e.hold=f,e.bits=h,wa(t,s),c=t.next_out,a=t.output,p=t.avail_out,o=t.next_in,r=t.input,d=t.avail_in,f=e.hold,h=e.bits,e.mode===W&&(e.back=-1);break}for(e.back=0;m=e.lencode[f&(1<<e.lenbits)-1],_=m>>>24,y=m>>>16&255,b=m&65535,!(_<=h);){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(y&&!(y&240)){for(w=_,k=y,F=b;m=e.lencode[F+((f&(1<<w+k)-1)>>w)],_=m>>>24,y=m>>>16&255,b=m&65535,!(w+_<=h);){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}f>>>=w,h-=w,e.back+=w}if(f>>>=_,h-=_,e.back+=_,e.length=b,y===0){e.mode=vn;break}if(y&32){e.back=-1,e.mode=W;break}if(y&64){t.msg="invalid literal/length code",e.mode=I;break}e.extra=y&15,e.mode=mn;case mn:if(e.extra){for(E=e.extra;h<E;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}e.length+=f&(1<<e.extra)-1,f>>>=e.extra,h-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=gn;case gn:for(;m=e.distcode[f&(1<<e.distbits)-1],_=m>>>24,y=m>>>16&255,b=m&65535,!(_<=h);){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(!(y&240)){for(w=_,k=y,F=b;m=e.distcode[F+((f&(1<<w+k)-1)>>w)],_=m>>>24,y=m>>>16&255,b=m&65535,!(w+_<=h);){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}f>>>=w,h-=w,e.back+=w}if(f>>>=_,h-=_,e.back+=_,y&64){t.msg="invalid distance code",e.mode=I;break}e.offset=b,e.extra=y&15,e.mode=wn;case wn:if(e.extra){for(E=e.extra;h<E;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}e.offset+=f&(1<<e.extra)-1,f>>>=e.extra,h-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=I;break}e.mode=yn;case yn:if(p===0)break e;if(l=s-p,e.offset>l){if(l=e.offset-l,l>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=I;break}l>e.wnext?(l-=e.wnext,u=e.wsize-l):u=e.wnext-l,l>e.length&&(l=e.length),g=e.window}else g=a,u=c-e.offset,l=e.length;l>p&&(l=p),p-=l,e.length-=l;do a[c++]=g[u++];while(--l);e.length===0&&(e.mode=We);break;case vn:if(p===0)break e;a[c++]=e.length,p--,e.mode=We;break;case mt:if(e.wrap){for(;h<32;){if(d===0)break e;d--,f|=r[o++]<<h,h+=8}if(s-=p,t.total_out+=s,e.total+=s,e.wrap&4&&s&&(t.adler=e.check=e.flags?O(e.check,a,s,c-s):Re(e.check,a,s,c-s)),s=p,e.wrap&4&&(e.flags?f:An(f))!==e.check){t.msg="incorrect data check",e.mode=I;break}f=0,h=0}e.mode=bn;case bn:if(e.wrap&&e.flags){for(;h<32;){if(d===0)break e;d--,f+=r[o++]<<h,h+=8}if(e.wrap&4&&f!==(e.total&4294967295)){t.msg="incorrect length check",e.mode=I;break}f=0,h=0}e.mode=xn;case xn:M=Ea;break e;case I:M=ei;break e;case ni:return ti;case ii:default:return N}return t.next_out=c,t.avail_out=p,t.next_in=o,t.avail_in=d,e.hold=f,e.bits=h,(e.wsize||s!==t.avail_out&&e.mode<I&&(e.mode<mt||n!==Qt))&&li(t,t.output,t.next_out,s-t.avail_out),i-=t.avail_in,s-=t.avail_out,t.total_in+=i,t.total_out+=s,e.total+=s,e.wrap&4&&s&&(t.adler=e.check=e.flags?O(e.check,a,s,t.next_out-s):Re(e.check,a,s,t.next_out-s)),t.data_type=e.bits+(e.last?64:0)+(e.mode===W?128:0)+(e.mode===Ye||e.mode===pt?256:0),(i===0&&s===0||n===Qt)&&M===ue&&(M=Ma),M},za=t=>{if(he(t))return N;let n=t.state;return n.window&&(n.window=null),t.state=null,ue},Ba=(t,n)=>{if(he(t))return N;const e=t.state;return e.wrap&2?(e.head=n,n.done=!1,ue):N},Ha=(t,n)=>{const e=n.length;let r,a,o;return he(t)||(r=t.state,r.wrap!==0&&r.mode!==tt)?N:r.mode===tt&&(a=1,a=Re(a,n,e,0),a!==r.check)?ei:(o=li(t,n,e,e),o?(r.mode=ni,ti):(r.havedict=1,ue))};var Ka=ai,Na=si,Za=ri,$a=Da,Ua=oi,Ga=Ra,Va=za,Xa=Ba,Ya=Ha,Wa="pako inflate (from Nodeca project)",q={inflateReset:Ka,inflateReset2:Na,inflateResetKeep:Za,inflateInit:$a,inflateInit2:Ua,inflate:Ga,inflateEnd:Va,inflateGetHeader:Xa,inflateSetDictionary:Ya,inflateInfo:Wa};function ja(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Ja=ja;const ci=Object.prototype.toString,{Z_NO_FLUSH:qa,Z_FINISH:Qa,Z_OK:He,Z_STREAM_END:yt,Z_NEED_DICT:vt,Z_STREAM_ERROR:es,Z_DATA_ERROR:kn,Z_MEM_ERROR:ts}=Ne;function Ue(t){this.options=rt.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jn,this.strm.avail_out=0;let e=q.inflateInit2(this.strm,n.windowBits);if(e!==He)throw new Error(fe[e]);if(this.header=new Ja,q.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Be.string2buf(n.dictionary):ci.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=q.inflateSetDictionary(this.strm,n.dictionary),e!==He)))throw new Error(fe[e])}Ue.prototype.push=function(t,n){const e=this.strm,r=this.options.chunkSize,a=this.options.dictionary;let o,c,d;if(this.ended)return!1;for(n===~~n?c=n:c=n===!0?Qa:qa,ci.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),o=q.inflate(e,c),o===vt&&a&&(o=q.inflateSetDictionary(e,a),o===He?o=q.inflate(e,c):o===kn&&(o=vt));e.avail_in>0&&o===yt&&e.state.wrap>0&&t[e.next_in]!==0;)q.inflateReset(e),o=q.inflate(e,c);switch(o){case es:case kn:case vt:case ts:return this.onEnd(o),this.ended=!0,!1}if(d=e.avail_out,e.next_out&&(e.avail_out===0||o===yt))if(this.options.to==="string"){let p=Be.utf8border(e.output,e.next_out),f=e.next_out-p,h=Be.buf2string(e.output,p);e.next_out=f,e.avail_out=r-f,f&&e.output.set(e.output.subarray(p,p+f),0),this.onData(h)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(o===He&&d===0)){if(o===yt)return o=q.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};Ue.prototype.onData=function(t){this.chunks.push(t)};Ue.prototype.onEnd=function(t){t===He&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=rt.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function zt(t,n){const e=new Ue(n);if(e.push(t),e.err)throw e.msg||fe[e.err];return e.result}function ns(t,n){return n=n||{},n.raw=!0,zt(t,n)}var is=Ue,rs=zt,as=ns,ss=zt,os={Inflate:is,inflate:rs,inflateRaw:as,ungzip:ss};const{Deflate:ls,deflate:cs,deflateRaw:fs,gzip:ds}=ma,{Inflate:us,inflate:hs,inflateRaw:_s,ungzip:ps}=os;var fi=ls,di=cs,ui=fs,hi=ds,_i=us,pi=hs,mi=_s,gi=ps,wi=Ne,ms={Deflate:fi,deflate:di,deflateRaw:ui,gzip:hi,Inflate:_i,inflate:pi,inflateRaw:mi,ungzip:gi,constants:wi};const gs=Object.freeze(Object.defineProperty({__proto__:null,Deflate:fi,Inflate:_i,constants:wi,default:ms,deflate:di,deflateRaw:ui,gzip:hi,inflate:pi,inflateRaw:mi,ungzip:gi},Symbol.toStringTag,{value:"Module"})),ws=Phaser.Input.Keyboard.Key,En=Phaser.Input.Keyboard.KeyCodes,Tn=["up","down","left","right"];class ys{constructor(n){this.scene=n,this.keys={},this.cursorKeys={},this.noKeyDown=!0;for(var e=0,r=Tn.length;e<r;e++){var a=Tn[e];this.addKey(a),this.cursorKeys[a]=this.keys[a]}}shutdown(n){this.scene=void 0;for(var e in this.keys)this.keys[e].destroy();this.keys=void 0,this.cursorKeys=void 0}destroy(n){shutdown(n)}createCursorKeys(){return this.cursorKeys}setKeyState(n,e){var r=this.keys[n];return r.enabled?(e&&(this.noKeyDown=!1),r.isDown!==e&&(je.timeStamp=Date.now(),je.keyCode=r.keyCode,e?r.onDown(je):r.onUp(je)),this):this}clearAllKeysState(){this.noKeyDown=!0;for(var n in this.keys)this.setKeyState(n,!1);return this}getKeyState(n){return this.keys[n]}get upKeyDown(){return this.keys.up.isDown}get downKeyDown(){return this.keys.down.isDown}get leftKeyDown(){return this.keys.left.isDown}get rightKeyDown(){return this.keys.right.isDown}get anyKeyDown(){return!this.noKeyDown}addKey(n,e){return e===void 0&&(e=n),typeof e=="string"&&(e=e.toUpperCase(),En.hasOwnProperty(e)&&(e=En[e])),this.keys[n]=new ws(this.scene,e),this}addKeys(n){for(var e=0,r=n.length;e<r;e++)this.addKey(n[e]);return this}}var je={timeStamp:0,keyCode:0,altKey:!1,ctrlKey:!1,shiftKey:!1,metaKey:!1,location:0};/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2018 Photon Storm Ltd.
 * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
 */var vs=180/Math.PI,bs=function(t){return t*vs};const xs={"up&down":0,"left&right":1,"4dir":2,"8dir":3};var As=function(t,n,e){switch(e===void 0?e={}:e===!0&&(e=Ss),e.left=!1,e.right=!1,e.up=!1,e.down=!1,t=(t+360)%360,n){case 0:t<180?e.down=!0:e.up=!0;break;case 1:t>90&&t<=270?e.left=!0:e.right=!0;break;case 2:t>45&&t<=135?e.down=!0:t>135&&t<=225?e.left=!0:t>225&&t<=315?e.up=!0:e.right=!0;break;case 3:t>22.5&&t<=67.5?(e.down=!0,e.right=!0):t>67.5&&t<=112.5?e.down=!0:t>112.5&&t<=157.5?(e.down=!0,e.left=!0):t>157.5&&t<=202.5?e.left=!0:t>202.5&&t<=247.5?(e.left=!0,e.up=!0):t>247.5&&t<=292.5?e.up=!0:(t>292.5&&t<=337.5&&(e.up=!0),e.right=!0);break}return e},Ss={};const se=Phaser.Utils.Objects.GetValue,ks=Phaser.Math.Distance.Between,Es=Phaser.Math.Angle.Between;class Ts extends ys{constructor(n,e){super(n),this.resetFromJSON(e)}resetFromJSON(n){this.start==null&&(this.start={x:0,y:0}),this.end==null&&(this.end={x:0,y:0}),this._enable=void 0,this.setEnable(se(n,"enable",!0)),this.setMode(se(n,"dir","8dir")),this.setDistanceThreshold(se(n,"forceMin",16));var e=se(n,"start.x",null),r=se(n,"start.y",null),a=se(n,"end.x",null),o=se(n,"end.y",null);return this.setVector(e,r,a,o),this}toJSON(){return{enable:this.enable,dir:this.dirMode,forceMin:this.forceMin,start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}}}setMode(n){return typeof n=="string"&&(n=xs[n]),this.dirMode=n,this}get enable(){return this._enable}set enable(n){if(this._enable!==n)return n||this.clearVector(),this._enable=n,this}setEnable(n){return n===void 0&&(n=!0),this.enable=n,this}toggleEnable(){return this.setEnable(!this.enable),this}setDistanceThreshold(n){return n<0&&(n=0),this.forceMin=n,this}clearVector(){return this.start.x=0,this.start.y=0,this.end.x=0,this.end.y=0,this.clearAllKeysState(),this}setVector(n,e,r,a){if(!this.enable)return this;if(n===null)return this.clearVector(),this;if(r===void 0&&(r=n,n=0,a=e,e=0),this.start.x=n,this.start.y=e,this.end.x=r,this.end.y=a,this.forceMin>0&&this.force<this.forceMin)this.clearAllKeysState();else{this.noKeyDown=!0;var o=As(this.angle,this.dirMode,!0);for(var c in o)this.setKeyState(c,o[c])}return this}get forceX(){return this.end.x-this.start.x}get forceY(){return this.end.y-this.start.y}get force(){return ks(this.start.x,this.start.y,this.end.x,this.end.y)}get rotation(){return Es(this.start.x,this.start.y,this.end.x,this.end.y)}get angle(){return bs(this.rotation)}get octant(){var n=0;return this.rightKeyDown?n=this.downKeyDown?45:0:this.downKeyDown?n=this.leftKeyDown?135:90:this.leftKeyDown?n=this.upKeyDown?225:180:this.upKeyDown&&(n=this.rightKeyDown?315:270),n}}const yi={setEventEmitter(t,n){return n===void 0&&(n=Phaser.Events.EventEmitter),this._privateEE=t===!0||t===void 0,this._eventEmitter=this._privateEE?new n:t,this},destroyEventEmitter(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter(){return this._eventEmitter},on(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}};var Ms=function(t,n,e){var r=t.camera;return r?(e===void 0?e={}:e===!0&&(e=Ps),r===n?(e.x=t.worldX,e.y=t.worldY):r.getWorldPoint(t.x,t.y,e),e):null},Ps={};const bt=Phaser.Utils.Objects.GetValue,Fs=Phaser.Geom.Circle,Is=Phaser.Geom.Circle.Contains;class vi extends Ts{constructor(n,e){var r=n.scene;super(r,e);var a=bt(e,"eventEmitter",void 0),o=bt(e,"EventEmitterClass",void 0);this.setEventEmitter(a,o),this.scene=r,this.mainCamera=r.sys.cameras.main,this.pointer=void 0,this.gameObject=n,this.radius=bt(e,"radius",100),n.setInteractive(new Fs(n.displayOriginX,n.displayOriginY,this.radius),Is),this.boot()}resetFromJSON(n){return super.resetFromJSON(n),this.pointer=void 0,this}toJSON(){var n=super.toJSON();return n.radius=this.radius,n}boot(){this.gameObject.on("pointerdown",this.onKeyDownStart,this),this.gameObject.on("pointerover",this.onKeyDownStart,this),this.scene.input.on("pointermove",this.onKeyDown,this),this.scene.input.on("pointerup",this.onKeyUp,this),this.gameObject.once("destroy",this.onParentDestroy,this)}shutdown(n){this.scene&&(this.scene.input.off("pointermove",this.onKeyDown,this),this.scene.input.off("pointerup",this.onKeyUp,this),this.destroyEventEmitter(),this.scene=void 0,this.mainCamera=void 0,this.pointer=void 0,this.gameObject=void 0,super.shutdown())}get enable(){return this._enable}set enable(n){if(this._enable!==n)return n||(this.pointer=void 0),super.enable=n,this}destroy(n){this.shutdown(n)}onParentDestroy(n,e){this.destroy(e)}onKeyDownStart(n){!n.isDown||this.pointer!==void 0||(this.pointer=n,this.onKeyDown(n),this.emit("pointerdown",n))}onKeyDown(n){if(this.pointer===n){var e=Ms(n,this.mainCamera,!0);if(e){var r=n.camera,a=this.gameObject,o=a.x-r.scrollX*(a.scrollFactorX-1),c=a.y-r.scrollY*(a.scrollFactorY-1);this.setVector(o,c,e.x,e.y),this.emit("update")}}}onKeyUp(n){this.pointer===n&&(this.pointer=void 0,this.clearVector(),this.emit("update"),this.emit("pointerup",n))}forceUpdate(){var n=this.pointer;return!n||!n.isDown?this:(this.onKeyDown(n),this)}}Object.assign(vi.prototype,yi);const ee=Phaser.Utils.Objects.GetValue;class bi{constructor(n,e){e===void 0&&(e={});var r=ee(e,"eventEmitter",void 0),a=ee(e,"EventEmitterClass",void 0);this.setEventEmitter(r,a),e.eventEmitter=this.getEventEmitter(),this.scene=n,this.base=void 0,this.thumb=void 0,this.touchCursor=void 0,this.setRadius(ee(e,"radius",100)),this.addBase(ee(e,"base",void 0),e),this.addThumb(ee(e,"thumb",void 0));var o=ee(e,"x",0),c=ee(e,"y",0);this.base.setPosition(o,c),this.thumb.setPosition(o,c),ee(e,"fixed",!0)&&this.setScrollFactor(0),this.boot()}destroy(){this.destroyEventEmitter(),this.base.destroy(),this.thumb.destroy(),this.scene=void 0,this.base=void 0,this.thumb=void 0,this.touchCursor=void 0}createCursorKeys(){return this.touchCursor.createCursorKeys()}get forceX(){return this.touchCursor.forceX}get forceY(){return this.touchCursor.forceY}get force(){return this.touchCursor.force}get rotation(){return this.touchCursor.rotation}get angle(){return this.touchCursor.angle}get up(){return this.touchCursor.upKeyDown}get down(){return this.touchCursor.downKeyDown}get left(){return this.touchCursor.leftKeyDown}get right(){return this.touchCursor.rightKeyDown}get noKey(){return this.touchCursor.noKeyDown}get pointerX(){return this.touchCursor.end.x}get pointerY(){return this.touchCursor.end.y}get pointer(){return this.touchCursor.pointer}setPosition(n,e){return this.x===n&&this.y===e?this:(this.x=n,this.y=e,this.forceUpdateThumb(),this)}set x(n){this.x!==n&&(this.base.x=n,this.thumb.x=n)}set y(n){this.y!==n&&(this.base.y=n,this.thumb.y=n)}get x(){return this.base.x}get y(){return this.base.y}setVisible(n){return this.visible=n,this}toggleVisible(){return this.visible=!this.visible,this}get visible(){return this.base.visible}set visible(n){this.base.visible=n,this.thumb.visible=n,this.enable=n}get enable(){return this.touchCursor.enable}set enable(n){this.touchCursor.setEnable(n)}setEnable(n){return n===void 0&&(n=!0),this.enable=n,this}toggleEnable(){return this.setEnable(!this.enable),this}setRadius(n){return this.radius=n,this}addBase(n,e){return this.base&&this.base.destroy(),n===void 0&&(n=this.scene.add.circle(0,0,this.radius).setStrokeStyle(3,255)),e===void 0&&(e={}),e.eventEmitter=this.getEventEmitter(),this.touchCursor=new vi(n,e),this.base=n,this}addThumb(n){return this.thumb&&this.thumb.destroy(),n===void 0&&(n=this.scene.add.circle(0,0,40).setStrokeStyle(3,65280)),this.thumb=n,this}setScrollFactor(n){return this.base.setScrollFactor(n),this.thumb.setScrollFactor(n),this}boot(){this.on("update",this.update,this)}update(){var n=this.touchCursor,e,r,a=n.dirMode;if(n.anyKeyDown)if(n.force>this.radius){var o=n.rotation;e=a!==0?Math.cos(o)*this.radius:0,r=a!==1?Math.sin(o)*this.radius:0}else e=a!==0?n.forceX:0,r=a!==1?n.forceY:0;else e=0,r=0;return this.thumb.x=this.base.x+e,this.thumb.y=this.base.y+r,this}forceUpdateThumb(){return this.touchCursor.forceUpdate(),this}}Object.assign(bi.prototype,yi);const Me=.2;function Je(t,n=Me){return Math.abs(t)<n?0:t<0?-1:1}var Bt=(t=>(t.MOVE_LEFT="moveLeft",t.MOVE_RIGHT="moveRight",t.MOVE_UP="moveUp",t.MOVE_DOWN="moveDown",t.JUMP="jump",t.ATTACK="attack",t.PRIMARY_FIRE="primaryFire",t.SECONDARY_FIRE="secondaryFire",t.WEAPON_NEXT="weaponNext",t.WEAPON_PREV="weaponPrev",t.PAUSE="pause",t))(Bt||{});class Cs{constructor(n){v(this,"scene");v(this,"keys");v(this,"previousActions");v(this,"currentActions");v(this,"virtualJoystick",null);v(this,"gamepadIndex",0);v(this,"keysPressed",new Set);v(this,"mobileJumpPressed",!1);v(this,"mobileFirePressed",!1);this.scene=n,this.keys=new Map,this.previousActions=new Set,this.currentActions=new Set}setupKeyboard(){if(!this.scene.input.keyboard){console.error("InputMapper: Keyboard not available!");return}console.log("InputMapper: Setting up keyboard..."),this.scene.input.keyboard.on("keydown",n=>{this.keysPressed.add(n.code)}),this.scene.input.keyboard.on("keyup",n=>{this.keysPressed.delete(n.code)}),console.log("InputMapper: Keyboard setup complete with event listeners")}setupVirtualJoystick(){if(!("ontouchstart"in window))return;const n=this.scene.add.circle(0,0,50,8947848,.5),e=this.scene.add.circle(0,0,25,13421772,.8);n.setVisible(!1),e.setVisible(!1);const r=this.scene.scale.width/2,a=this.scene.add.zone(r/2,this.scene.scale.height/2,r,this.scene.scale.height);a.setInteractive(),a.setScrollFactor(0),a.setDepth(9998),this.virtualJoystick=new bi(this.scene,{x:r/2,y:this.scene.scale.height/2,radius:50,base:n,thumb:e,dir:"8dir",forceMin:16,enable:!0,fixed:!1}),n.setScrollFactor(0).setDepth(9999),e.setScrollFactor(0).setDepth(1e4);let o=null;a.on("pointerdown",c=>{console.log("Touch zone touched at",c.x,c.y),o=c,n.setPosition(c.x,c.y),e.setPosition(c.x,c.y),n.setVisible(!0),e.setVisible(!0),this.virtualJoystick.x=c.x,this.virtualJoystick.y=c.y,this.virtualJoystick.setPosition(c.x,c.y)}),a.on("pointerup",c=>{o===c&&(console.log("Touch zone released"),o=null,n.setVisible(!1),e.setVisible(!1))}),this.createMobileActionButtons()}createMobileActionButtons(){const n=this.scene.scale.height-60,e=this.scene.add.graphics();e.fillStyle(65280,.6),e.fillCircle(this.scene.scale.width-80,n,30),e.setInteractive(new C.Geom.Circle(this.scene.scale.width-80,n,30),C.Geom.Circle.Contains),e.setScrollFactor(0),e.setDepth(9999),e.on("pointerdown",()=>{console.log("Jump button pressed"),this.mobileJumpPressed=!0}),e.on("pointerup",()=>{console.log("Jump button released"),this.mobileJumpPressed=!1}),e.on("pointerout",()=>{this.mobileJumpPressed=!1});const r=this.scene.add.graphics();r.fillStyle(16711680,.6),r.fillCircle(this.scene.scale.width-80,n-80,30),r.setInteractive(new C.Geom.Circle(this.scene.scale.width-80,n-80,30),C.Geom.Circle.Contains),r.setScrollFactor(0),r.setDepth(9999),r.on("pointerdown",()=>{console.log("Fire button pressed"),this.mobileFirePressed=!0}),r.on("pointerup",()=>{console.log("Fire button released"),this.mobileFirePressed=!1}),r.on("pointerout",()=>{this.mobileFirePressed=!1})}setScene(n){this.scene=n,this.setupKeyboard(),this.setupVirtualJoystick()}update(){this.previousActions=new Set(this.currentActions),this.currentActions.clear(),this.updateKeyboardInput(),this.updateGamepadInput(),this.updateVirtualJoystickInput(),this.updateMobileInput()}updateMobileInput(){this.mobileJumpPressed&&this.currentActions.add("jump"),this.mobileFirePressed&&this.currentActions.add("primaryFire")}updateKeyboardInput(){const n=this.keysPressed.has("ArrowLeft")||this.keysPressed.has("KeyA"),e=this.keysPressed.has("ArrowRight")||this.keysPressed.has("KeyD"),r=this.keysPressed.has("ArrowUp")||this.keysPressed.has("KeyW"),a=this.keysPressed.has("ArrowDown")||this.keysPressed.has("KeyS");n&&this.currentActions.add("moveLeft"),e&&this.currentActions.add("moveRight"),r&&this.currentActions.add("moveUp"),a&&this.currentActions.add("moveDown"),(this.keysPressed.has("Space")||r)&&this.currentActions.add("jump"),(this.keysPressed.has("KeyZ")||this.keysPressed.has("KeyJ"))&&this.currentActions.add("primaryFire"),(this.keysPressed.has("KeyX")||this.keysPressed.has("KeyK"))&&this.currentActions.add("secondaryFire"),this.keysPressed.has("KeyQ")&&this.currentActions.add("weaponPrev"),this.keysPressed.has("KeyE")&&this.currentActions.add("weaponNext"),this.keysPressed.has("Escape")&&this.currentActions.add("pause"),(this.keysPressed.has("KeyZ")||this.keysPressed.has("KeyX"))&&this.currentActions.add("attack")}updateGamepadInput(){const e=(navigator.getGamepads?navigator.getGamepads():[])[this.gamepadIndex];if(!e)return;const r=e.axes,a=Je(r[0],Me),o=Je(r[1],Me);(a<0||e.buttons[14]?.pressed)&&this.currentActions.add("moveLeft"),(a>0||e.buttons[15]?.pressed)&&this.currentActions.add("moveRight"),(o<0||e.buttons[12]?.pressed)&&this.currentActions.add("moveUp"),(o>0||e.buttons[13]?.pressed)&&this.currentActions.add("moveDown"),e.buttons[0]?.pressed&&this.currentActions.add("jump"),e.buttons[2]?.pressed&&this.currentActions.add("primaryFire"),e.buttons[1]?.pressed&&this.currentActions.add("secondaryFire"),e.buttons[4]?.pressed&&this.currentActions.add("weaponPrev"),e.buttons[5]?.pressed&&this.currentActions.add("weaponNext"),e.buttons[9]?.pressed&&this.currentActions.add("pause"),e.buttons[2]?.pressed&&this.currentActions.add("attack")}updateVirtualJoystickInput(){if(!this.virtualJoystick)return;const n=this.virtualJoystick.forceX||0,e=this.virtualJoystick.forceY||0;(n!==0||e!==0)&&console.log("VirtualJoystick force:",n,e);const r=Je(n,Me),a=Je(e,Me);r<0&&this.currentActions.add("moveLeft"),r>0&&this.currentActions.add("moveRight"),a<0&&this.currentActions.add("moveUp"),a>0&&this.currentActions.add("moveDown")}isActionActive(n){return this.currentActions.has(n)}isActionJustPressed(n){return this.currentActions.has(n)&&!this.previousActions.has(n)}getAxis(){let n=0,e=0;return this.isActionActive("moveLeft")&&(n-=1),this.isActionActive("moveRight")&&(n+=1),this.isActionActive("moveUp")&&(e-=1),this.isActionActive("moveDown")&&(e+=1),{x:n,y:e}}getInputState(){return{moveX:this.getAxis().x,moveY:this.getAxis().y,jumpActive:this.isActionActive("jump"),jumpJustPressed:this.isActionJustPressed("jump"),primaryFire:this.isActionActive("primaryFire"),primaryFireJustPressed:this.isActionJustPressed("primaryFire"),secondaryFire:this.isActionActive("secondaryFire"),secondaryFireJustPressed:this.isActionJustPressed("secondaryFire"),weaponNext:this.isActionJustPressed("weaponNext"),weaponPrevious:this.isActionJustPressed("weaponPrev"),pause:this.isActionActive("pause"),pauseJustPressed:this.isActionJustPressed("pause")}}destroy(){this.keys.clear(),this.currentActions.clear(),this.previousActions.clear()}}var j={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(t){(function(){var n=function(){this.init()};n.prototype={init:function(){var i=this||e;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var s=this||e;if(i=parseFloat(i),s.ctx||h(),typeof i<"u"&&i>=0&&i<=1){if(s._volume=i,s._muted)return s;s.usingWebAudio&&s.masterGain.gain.setValueAtTime(i,e.ctx.currentTime);for(var l=0;l<s._howls.length;l++)if(!s._howls[l]._webAudio)for(var u=s._howls[l]._getSoundIds(),g=0;g<u.length;g++){var m=s._howls[l]._soundById(u[g]);m&&m._node&&(m._node.volume=m._volume*i)}return s}return s._volume},mute:function(i){var s=this||e;s.ctx||h(),s._muted=i,s.usingWebAudio&&s.masterGain.gain.setValueAtTime(i?0:s._volume,e.ctx.currentTime);for(var l=0;l<s._howls.length;l++)if(!s._howls[l]._webAudio)for(var u=s._howls[l]._getSoundIds(),g=0;g<u.length;g++){var m=s._howls[l]._soundById(u[g]);m&&m._node&&(m._node.muted=i?!0:m._muted)}return s},stop:function(){for(var i=this||e,s=0;s<i._howls.length;s++)i._howls[s].stop();return i},unload:function(){for(var i=this||e,s=i._howls.length-1;s>=0;s--)i._howls[s].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,h()),i},codecs:function(i){return(this||e)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||e;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var s=new Audio;typeof s.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var s=new Audio;s.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||e,s=null;try{s=typeof Audio<"u"?new Audio:null}catch{return i}if(!s||typeof s.canPlayType!="function")return i;var l=s.canPlayType("audio/mpeg;").replace(/^no$/,""),u=i._navigator?i._navigator.userAgent:"",g=u.match(/OPR\/(\d+)/g),m=g&&parseInt(g[0].split("/")[1],10)<33,_=u.indexOf("Safari")!==-1&&u.indexOf("Chrome")===-1,y=u.match(/Version\/(.*?) /),b=_&&y&&parseInt(y[1],10)<15;return i._codecs={mp3:!!(!m&&(l||s.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!l,opus:!!s.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(s.canPlayType('audio/wav; codecs="1"')||s.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!s.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!s.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(s.canPlayType("audio/x-m4a;")||s.canPlayType("audio/m4a;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(s.canPlayType("audio/x-m4b;")||s.canPlayType("audio/m4b;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(s.canPlayType("audio/x-mp4;")||s.canPlayType("audio/mp4;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!s.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(s.canPlayType("audio/x-flac;")||s.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||e;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var s=function(l){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var u=new Audio;u._unlocked=!0,i._releaseHtml5Audio(u)}catch{i.noAudio=!0;break}for(var g=0;g<i._howls.length;g++)if(!i._howls[g]._webAudio)for(var m=i._howls[g]._getSoundIds(),_=0;_<m.length;_++){var y=i._howls[g]._soundById(m[_]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}i._autoResume();var b=i.ctx.createBufferSource();b.buffer=i._scratchBuffer,b.connect(i.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),b.onended=function(){b.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",s,!0),document.removeEventListener("click",s,!0),document.removeEventListener("keydown",s,!0);for(var w=0;w<i._howls.length;w++)i._howls[w]._emit("unlock")}};return document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",s,!0),document.addEventListener("click",s,!0),document.addEventListener("keydown",s,!0),i}},_obtainHtml5Audio:function(){var i=this||e;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var s=new Audio().play();return s&&typeof Promise<"u"&&(s instanceof Promise||typeof s.then=="function")&&s.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var s=this||e;return i._unlocked&&s._html5AudioPool.push(i),s},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!e.usingWebAudio)){for(var s=0;s<i._howls.length;s++)if(i._howls[s]._webAudio){for(var l=0;l<i._howls[s]._sounds.length;l++)if(!i._howls[s]._sounds[l]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var u=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(u,u)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!e.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var s=0;s<i._howls.length;s++)i._howls[s]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var e=new n,r=function(i){var s=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}s.init(i)};r.prototype={init:function(i){var s=this;return e.ctx||h(),s._autoplay=i.autoplay||!1,s._format=typeof i.format!="string"?i.format:[i.format],s._html5=i.html5||!1,s._muted=i.mute||!1,s._loop=i.loop||!1,s._pool=i.pool||5,s._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,s._rate=i.rate||1,s._sprite=i.sprite||{},s._src=typeof i.src!="string"?i.src:[i.src],s._volume=i.volume!==void 0?i.volume:1,s._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},s._duration=0,s._state="unloaded",s._sounds=[],s._endTimers={},s._queue=[],s._playLock=!1,s._onend=i.onend?[{fn:i.onend}]:[],s._onfade=i.onfade?[{fn:i.onfade}]:[],s._onload=i.onload?[{fn:i.onload}]:[],s._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],s._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],s._onpause=i.onpause?[{fn:i.onpause}]:[],s._onplay=i.onplay?[{fn:i.onplay}]:[],s._onstop=i.onstop?[{fn:i.onstop}]:[],s._onmute=i.onmute?[{fn:i.onmute}]:[],s._onvolume=i.onvolume?[{fn:i.onvolume}]:[],s._onrate=i.onrate?[{fn:i.onrate}]:[],s._onseek=i.onseek?[{fn:i.onseek}]:[],s._onunlock=i.onunlock?[{fn:i.onunlock}]:[],s._onresume=[],s._webAudio=e.usingWebAudio&&!s._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(s),s._autoplay&&s._queue.push({event:"play",action:function(){s.play()}}),s._preload&&s._preload!=="none"&&s.load(),s},load:function(){var i=this,s=null;if(e.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var l=0;l<i._src.length;l++){var u,g;if(i._format&&i._format[l])u=i._format[l];else{if(g=i._src[l],typeof g!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(g),u||(u=/\.([^.]+)$/.exec(g.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&e.codecs(u)){s=i._src[l];break}}if(!s){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=s,i._state="loading",window.location.protocol==="https:"&&s.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new a(i),i._webAudio&&c(i),i},play:function(i,s){var l=this,u=null;if(typeof i=="number")u=i,i=null;else{if(typeof i=="string"&&l._state==="loaded"&&!l._sprite[i])return null;if(typeof i>"u"&&(i="__default",!l._playLock)){for(var g=0,m=0;m<l._sounds.length;m++)l._sounds[m]._paused&&!l._sounds[m]._ended&&(g++,u=l._sounds[m]._id);g===1?i=null:u=null}}var _=u?l._soundById(u):l._inactiveSound();if(!_)return null;if(u&&!i&&(i=_._sprite||"__default"),l._state!=="loaded"){_._sprite=i,_._ended=!1;var y=_._id;return l._queue.push({event:"play",action:function(){l.play(y)}}),y}if(u&&!_._paused)return s||l._loadQueue("play"),_._id;l._webAudio&&e._autoResume();var b=Math.max(0,_._seek>0?_._seek:l._sprite[i][0]/1e3),w=Math.max(0,(l._sprite[i][0]+l._sprite[i][1])/1e3-b),k=w*1e3/Math.abs(_._rate),F=l._sprite[i][0]/1e3,A=(l._sprite[i][0]+l._sprite[i][1])/1e3;_._sprite=i,_._ended=!1;var M=function(){_._paused=!1,_._seek=b,_._start=F,_._stop=A,_._loop=!!(_._loop||l._sprite[i][2])};if(b>=A){l._ended(_);return}var x=_._node;if(l._webAudio){var S=function(){l._playLock=!1,M(),l._refreshBuffer(_);var Z=_._muted||l._muted?0:_._volume;x.gain.setValueAtTime(Z,e.ctx.currentTime),_._playStart=e.ctx.currentTime,typeof x.bufferSource.start>"u"?_._loop?x.bufferSource.noteGrainOn(0,b,86400):x.bufferSource.noteGrainOn(0,b,w):_._loop?x.bufferSource.start(0,b,86400):x.bufferSource.start(0,b,w),k!==1/0&&(l._endTimers[_._id]=setTimeout(l._ended.bind(l,_),k)),s||setTimeout(function(){l._emit("play",_._id),l._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?S():(l._playLock=!0,l.once("resume",S),l._clearTimer(_._id))}else{var E=function(){x.currentTime=b,x.muted=_._muted||l._muted||e._muted||x.muted,x.volume=_._volume*e.volume(),x.playbackRate=_._rate;try{var Z=x.play();if(Z&&typeof Promise<"u"&&(Z instanceof Promise||typeof Z.then=="function")?(l._playLock=!0,M(),Z.then(function(){l._playLock=!1,x._unlocked=!0,s?l._loadQueue():l._emit("play",_._id)}).catch(function(){l._playLock=!1,l._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),_._ended=!0,_._paused=!0})):s||(l._playLock=!1,M(),l._emit("play",_._id)),x.playbackRate=_._rate,x.paused){l._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||_._loop?l._endTimers[_._id]=setTimeout(l._ended.bind(l,_),k):(l._endTimers[_._id]=function(){l._ended(_),x.removeEventListener("ended",l._endTimers[_._id],!1)},x.addEventListener("ended",l._endTimers[_._id],!1))}catch(_e){l._emit("playerror",_._id,_e)}};x.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(x.src=l._src,x.load());var Y=window&&window.ejecta||!x.readyState&&e._navigator.isCocoonJS;if(x.readyState>=3||Y)E();else{l._playLock=!0,l._state="loading";var Ae=function(){l._state="loaded",E(),x.removeEventListener(e._canPlayEvent,Ae,!1)};x.addEventListener(e._canPlayEvent,Ae,!1),l._clearTimer(_._id)}}return _._id},pause:function(i){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"pause",action:function(){s.pause(i)}}),s;for(var l=s._getSoundIds(i),u=0;u<l.length;u++){s._clearTimer(l[u]);var g=s._soundById(l[u]);if(g&&!g._paused&&(g._seek=s.seek(l[u]),g._rateSeek=0,g._paused=!0,s._stopFade(l[u]),g._node))if(s._webAudio){if(!g._node.bufferSource)continue;typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),s._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||s._emit("pause",g?g._id:null)}return s},stop:function(i,s){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"stop",action:function(){l.stop(i)}}),l;for(var u=l._getSoundIds(i),g=0;g<u.length;g++){l._clearTimer(u[g]);var m=l._soundById(u[g]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,l._stopFade(u[g]),m._node&&(l._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),l._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&l._clearSound(m._node))),s||l._emit("stop",m._id))}return l},mute:function(i,s){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"mute",action:function(){l.mute(i,s)}}),l;if(typeof s>"u")if(typeof i=="boolean")l._muted=i;else return l._muted;for(var u=l._getSoundIds(s),g=0;g<u.length;g++){var m=l._soundById(u[g]);m&&(m._muted=i,m._interval&&l._stopFade(m._id),l._webAudio&&m._node?m._node.gain.setValueAtTime(i?0:m._volume,e.ctx.currentTime):m._node&&(m._node.muted=e._muted?!0:i),l._emit("mute",m._id))}return l},volume:function(){var i=this,s=arguments,l,u;if(s.length===0)return i._volume;if(s.length===1||s.length===2&&typeof s[1]>"u"){var g=i._getSoundIds(),m=g.indexOf(s[0]);m>=0?u=parseInt(s[0],10):l=parseFloat(s[0])}else s.length>=2&&(l=parseFloat(s[0]),u=parseInt(s[1],10));var _;if(typeof l<"u"&&l>=0&&l<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,s)}}),i;typeof u>"u"&&(i._volume=l),u=i._getSoundIds(u);for(var y=0;y<u.length;y++)_=i._soundById(u[y]),_&&(_._volume=l,s[2]||i._stopFade(u[y]),i._webAudio&&_._node&&!_._muted?_._node.gain.setValueAtTime(l,e.ctx.currentTime):_._node&&!_._muted&&(_._node.volume=l*e.volume()),i._emit("volume",_._id))}else return _=u?i._soundById(u):i._sounds[0],_?_._volume:0;return i},fade:function(i,s,l,u){var g=this;if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(i,s,l,u)}}),g;i=Math.min(Math.max(0,parseFloat(i)),1),s=Math.min(Math.max(0,parseFloat(s)),1),l=parseFloat(l),g.volume(i,u);for(var m=g._getSoundIds(u),_=0;_<m.length;_++){var y=g._soundById(m[_]);if(y){if(u||g._stopFade(m[_]),g._webAudio&&!y._muted){var b=e.ctx.currentTime,w=b+l/1e3;y._volume=i,y._node.gain.setValueAtTime(i,b),y._node.gain.linearRampToValueAtTime(s,w)}g._startFadeInterval(y,i,s,l,m[_],typeof u>"u")}}return g},_startFadeInterval:function(i,s,l,u,g,m){var _=this,y=s,b=l-s,w=Math.abs(b/.01),k=Math.max(4,w>0?u/w:u),F=Date.now();i._fadeTo=l,i._interval=setInterval(function(){var A=(Date.now()-F)/u;F=Date.now(),y+=b*A,y=Math.round(y*100)/100,b<0?y=Math.max(l,y):y=Math.min(l,y),_._webAudio?i._volume=y:_.volume(y,i._id,!0),m&&(_._volume=y),(l<s&&y<=l||l>s&&y>=l)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,_.volume(l,i._id),_._emit("fade",i._id))},k)},_stopFade:function(i){var s=this,l=s._soundById(i);return l&&l._interval&&(s._webAudio&&l._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(l._interval),l._interval=null,s.volume(l._fadeTo,i),l._fadeTo=null,s._emit("fade",i)),s},loop:function(){var i=this,s=arguments,l,u,g;if(s.length===0)return i._loop;if(s.length===1)if(typeof s[0]=="boolean")l=s[0],i._loop=l;else return g=i._soundById(parseInt(s[0],10)),g?g._loop:!1;else s.length===2&&(l=s[0],u=parseInt(s[1],10));for(var m=i._getSoundIds(u),_=0;_<m.length;_++)g=i._soundById(m[_]),g&&(g._loop=l,i._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=l,l&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,i.playing(m[_])&&(i.pause(m[_],!0),i.play(m[_],!0)))));return i},rate:function(){var i=this,s=arguments,l,u;if(s.length===0)u=i._sounds[0]._id;else if(s.length===1){var g=i._getSoundIds(),m=g.indexOf(s[0]);m>=0?u=parseInt(s[0],10):l=parseFloat(s[0])}else s.length===2&&(l=parseFloat(s[0]),u=parseInt(s[1],10));var _;if(typeof l=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,s)}}),i;typeof u>"u"&&(i._rate=l),u=i._getSoundIds(u);for(var y=0;y<u.length;y++)if(_=i._soundById(u[y]),_){i.playing(u[y])&&(_._rateSeek=i.seek(u[y]),_._playStart=i._webAudio?e.ctx.currentTime:_._playStart),_._rate=l,i._webAudio&&_._node&&_._node.bufferSource?_._node.bufferSource.playbackRate.setValueAtTime(l,e.ctx.currentTime):_._node&&(_._node.playbackRate=l);var b=i.seek(u[y]),w=(i._sprite[_._sprite][0]+i._sprite[_._sprite][1])/1e3-b,k=w*1e3/Math.abs(_._rate);(i._endTimers[u[y]]||!_._paused)&&(i._clearTimer(u[y]),i._endTimers[u[y]]=setTimeout(i._ended.bind(i,_),k)),i._emit("rate",_._id)}}else return _=i._soundById(u),_?_._rate:i._rate;return i},seek:function(){var i=this,s=arguments,l,u;if(s.length===0)i._sounds.length&&(u=i._sounds[0]._id);else if(s.length===1){var g=i._getSoundIds(),m=g.indexOf(s[0]);m>=0?u=parseInt(s[0],10):i._sounds.length&&(u=i._sounds[0]._id,l=parseFloat(s[0]))}else s.length===2&&(l=parseFloat(s[0]),u=parseInt(s[1],10));if(typeof u>"u")return 0;if(typeof l=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,s)}}),i;var _=i._soundById(u);if(_)if(typeof l=="number"&&l>=0){var y=i.playing(u);y&&i.pause(u,!0),_._seek=l,_._ended=!1,i._clearTimer(u),!i._webAudio&&_._node&&!isNaN(_._node.duration)&&(_._node.currentTime=l);var b=function(){y&&i.play(u,!0),i._emit("seek",u)};if(y&&!i._webAudio){var w=function(){i._playLock?setTimeout(w,0):b()};setTimeout(w,0)}else b()}else if(i._webAudio){var k=i.playing(u)?e.ctx.currentTime-_._playStart:0,F=_._rateSeek?_._rateSeek-_._seek:0;return _._seek+(F+k*Math.abs(_._rate))}else return _._node.currentTime;return i},playing:function(i){var s=this;if(typeof i=="number"){var l=s._soundById(i);return l?!l._paused:!1}for(var u=0;u<s._sounds.length;u++)if(!s._sounds[u]._paused)return!0;return!1},duration:function(i){var s=this,l=s._duration,u=s._soundById(i);return u&&(l=s._sprite[u._sprite][1]/1e3),l},state:function(){return this._state},unload:function(){for(var i=this,s=i._sounds,l=0;l<s.length;l++)s[l]._paused||i.stop(s[l]._id),i._webAudio||(i._clearSound(s[l]._node),s[l]._node.removeEventListener("error",s[l]._errorFn,!1),s[l]._node.removeEventListener(e._canPlayEvent,s[l]._loadFn,!1),s[l]._node.removeEventListener("ended",s[l]._endFn,!1),e._releaseHtml5Audio(s[l]._node)),delete s[l]._node,i._clearTimer(s[l]._id);var u=e._howls.indexOf(i);u>=0&&e._howls.splice(u,1);var g=!0;for(l=0;l<e._howls.length;l++)if(e._howls[l]._src===i._src||i._src.indexOf(e._howls[l]._src)>=0){g=!1;break}return o&&g&&delete o[i._src],e.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,s,l,u){var g=this,m=g["_on"+i];return typeof s=="function"&&m.push(u?{id:l,fn:s,once:u}:{id:l,fn:s}),g},off:function(i,s,l){var u=this,g=u["_on"+i],m=0;if(typeof s=="number"&&(l=s,s=null),s||l)for(m=0;m<g.length;m++){var _=l===g[m].id;if(s===g[m].fn&&_||!s&&_){g.splice(m,1);break}}else if(i)u["_on"+i]=[];else{var y=Object.keys(u);for(m=0;m<y.length;m++)y[m].indexOf("_on")===0&&Array.isArray(u[y[m]])&&(u[y[m]]=[])}return u},once:function(i,s,l){var u=this;return u.on(i,s,l,1),u},_emit:function(i,s,l){for(var u=this,g=u["_on"+i],m=g.length-1;m>=0;m--)(!g[m].id||g[m].id===s||i==="load")&&(setTimeout(function(_){_.call(this,s,l)}.bind(u,g[m].fn),0),g[m].once&&u.off(i,g[m].fn,g[m].id));return u._loadQueue(i),u},_loadQueue:function(i){var s=this;if(s._queue.length>0){var l=s._queue[0];l.event===i&&(s._queue.shift(),s._loadQueue()),i||l.action()}return s},_ended:function(i){var s=this,l=i._sprite;if(!s._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(s._ended.bind(s,i),100),s;var u=!!(i._loop||s._sprite[l][2]);if(s._emit("end",i._id),!s._webAudio&&u&&s.stop(i._id,!0).play(i._id),s._webAudio&&u){s._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=e.ctx.currentTime;var g=(i._stop-i._start)*1e3/Math.abs(i._rate);s._endTimers[i._id]=setTimeout(s._ended.bind(s,i),g)}return s._webAudio&&!u&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,s._clearTimer(i._id),s._cleanBuffer(i._node),e._autoSuspend()),!s._webAudio&&!u&&s.stop(i._id,!0),s},_clearTimer:function(i){var s=this;if(s._endTimers[i]){if(typeof s._endTimers[i]!="function")clearTimeout(s._endTimers[i]);else{var l=s._soundById(i);l&&l._node&&l._node.removeEventListener("ended",s._endTimers[i],!1)}delete s._endTimers[i]}return s},_soundById:function(i){for(var s=this,l=0;l<s._sounds.length;l++)if(i===s._sounds[l]._id)return s._sounds[l];return null},_inactiveSound:function(){var i=this;i._drain();for(var s=0;s<i._sounds.length;s++)if(i._sounds[s]._ended)return i._sounds[s].reset();return new a(i)},_drain:function(){var i=this,s=i._pool,l=0,u=0;if(!(i._sounds.length<s)){for(u=0;u<i._sounds.length;u++)i._sounds[u]._ended&&l++;for(u=i._sounds.length-1;u>=0;u--){if(l<=s)return;i._sounds[u]._ended&&(i._webAudio&&i._sounds[u]._node&&i._sounds[u]._node.disconnect(0),i._sounds.splice(u,1),l--)}}},_getSoundIds:function(i){var s=this;if(typeof i>"u"){for(var l=[],u=0;u<s._sounds.length;u++)l.push(s._sounds[u]._id);return l}else return[i]},_refreshBuffer:function(i){var s=this;return i._node.bufferSource=e.ctx.createBufferSource(),i._node.bufferSource.buffer=o[s._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,e.ctx.currentTime),s},_cleanBuffer:function(i){var s=this,l=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!i.bufferSource)return s;if(e._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),l))try{i.bufferSource.buffer=e._scratchBuffer}catch{}return i.bufferSource=null,s},_clearSound:function(i){var s=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);s||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(i){this._parent=i,this.init()};a.prototype={init:function(){var i=this,s=i._parent;return i._muted=s._muted,i._loop=s._loop,i._volume=s._volume,i._rate=s._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,s._sounds.push(i),i.create(),i},create:function(){var i=this,s=i._parent,l=e._muted||i._muted||i._parent._muted?0:i._volume;return s._webAudio?(i._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),i._node.gain.setValueAtTime(l,e.ctx.currentTime),i._node.paused=!0,i._node.connect(e.masterGain)):e.noAudio||(i._node=e._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(e._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=s._src,i._node.preload=s._preload===!0?"auto":s._preload,i._node.volume=l*e.volume(),i._node.load()),i},reset:function(){var i=this,s=i._parent;return i._muted=s._muted,i._loop=s._loop,i._volume=s._volume,i._rate=s._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,s=i._parent;s._duration=Math.ceil(i._node.duration*10)/10,Object.keys(s._sprite).length===0&&(s._sprite={__default:[0,s._duration*1e3]}),s._state!=="loaded"&&(s._state="loaded",s._emit("load"),s._loadQueue()),i._node.removeEventListener(e._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,s=i._parent;s._duration===1/0&&(s._duration=Math.ceil(i._node.duration*10)/10,s._sprite.__default[1]===1/0&&(s._sprite.__default[1]=s._duration*1e3),s._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var o={},c=function(i){var s=i._src;if(o[s]){i._duration=o[s].duration,f(i);return}if(/^data:[^;]+;base64,/.test(s)){for(var l=atob(s.split(",")[1]),u=new Uint8Array(l.length),g=0;g<l.length;++g)u[g]=l.charCodeAt(g);p(u.buffer,i)}else{var m=new XMLHttpRequest;m.open(i._xhr.method,s,!0),m.withCredentials=i._xhr.withCredentials,m.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(_){m.setRequestHeader(_,i._xhr.headers[_])}),m.onload=function(){var _=(m.status+"")[0];if(_!=="0"&&_!=="2"&&_!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}p(m.response,i)},m.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete o[s],i.load())},d(m)}},d=function(i){try{i.send()}catch{i.onerror()}},p=function(i,s){var l=function(){s._emit("loaderror",null,"Decoding audio data failed.")},u=function(g){g&&s._sounds.length>0?(o[s._src]=g,f(s,g)):l()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(i).then(u).catch(l):e.ctx.decodeAudioData(i,u,l)},f=function(i,s){s&&!i._duration&&(i._duration=s.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},h=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),s=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),l=s?parseInt(s[1],10):null;if(i&&l&&l<9){var u=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!u&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};t.Howler=e,t.Howl=r,typeof Se<"u"?(Se.HowlerGlobal=n,Se.Howler=e,Se.Howl=r,Se.Sound=a):typeof window<"u"&&(window.HowlerGlobal=n,window.Howler=e,window.Howl=r,window.Sound=a)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var a=r._howls.length-1;a>=0;a--)r._howls[a].stereo(e);return r},HowlerGlobal.prototype.pos=function(e,r,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;if(r=typeof r!="number"?o._pos[1]:r,a=typeof a!="number"?o._pos[2]:a,typeof e=="number")o._pos=[e,r,a],typeof o.ctx.listener.positionX<"u"?(o.ctx.listener.positionX.setTargetAtTime(o._pos[0],Howler.ctx.currentTime,.1),o.ctx.listener.positionY.setTargetAtTime(o._pos[1],Howler.ctx.currentTime,.1),o.ctx.listener.positionZ.setTargetAtTime(o._pos[2],Howler.ctx.currentTime,.1)):o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]);else return o._pos;return o},HowlerGlobal.prototype.orientation=function(e,r,a,o,c,d){var p=this;if(!p.ctx||!p.ctx.listener)return p;var f=p._orientation;if(r=typeof r!="number"?f[1]:r,a=typeof a!="number"?f[2]:a,o=typeof o!="number"?f[3]:o,c=typeof c!="number"?f[4]:c,d=typeof d!="number"?f[5]:d,typeof e=="number")p._orientation=[e,r,a,o,c,d],typeof p.ctx.listener.forwardX<"u"?(p.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),p.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),p.ctx.listener.forwardZ.setTargetAtTime(a,Howler.ctx.currentTime,.1),p.ctx.listener.upX.setTargetAtTime(o,Howler.ctx.currentTime,.1),p.ctx.listener.upY.setTargetAtTime(c,Howler.ctx.currentTime,.1),p.ctx.listener.upZ.setTargetAtTime(d,Howler.ctx.currentTime,.1)):p.ctx.listener.setOrientation(e,r,a,o,c,d);else return f;return p},Howl.prototype.init=function(e){return function(r){var a=this;return a._orientation=r.orientation||[1,0,0],a._stereo=r.stereo||null,a._pos=r.pos||null,a._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},a._onstereo=r.onstereo?[{fn:r.onstereo}]:[],a._onpos=r.onpos?[{fn:r.onpos}]:[],a._onorientation=r.onorientation?[{fn:r.onorientation}]:[],e.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,r){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"stereo",action:function(){a.stereo(e,r)}}),a;var o=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof e=="number")a._stereo=e,a._pos=[e,0,0];else return a._stereo;for(var c=a._getSoundIds(r),d=0;d<c.length;d++){var p=a._soundById(c[d]);if(p)if(typeof e=="number")p._stereo=e,p._pos=[e,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",(!p._panner||!p._panner.pan)&&n(p,o),o==="spatial"?typeof p._panner.positionX<"u"?(p._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(e,0,0):p._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),a._emit("stereo",p._id);else return p._stereo}return a},Howl.prototype.pos=function(e,r,a,o){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"pos",action:function(){c.pos(e,r,a,o)}}),c;if(r=typeof r!="number"?0:r,a=typeof a!="number"?-.5:a,typeof o>"u")if(typeof e=="number")c._pos=[e,r,a];else return c._pos;for(var d=c._getSoundIds(o),p=0;p<d.length;p++){var f=c._soundById(d[p]);if(f)if(typeof e=="number")f._pos=[e,r,a],f._node&&((!f._panner||f._panner.pan)&&n(f,"spatial"),typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(a,Howler.ctx.currentTime)):f._panner.setPosition(e,r,a)),c._emit("pos",f._id);else return f._pos}return c},Howl.prototype.orientation=function(e,r,a,o){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"orientation",action:function(){c.orientation(e,r,a,o)}}),c;if(r=typeof r!="number"?c._orientation[1]:r,a=typeof a!="number"?c._orientation[2]:a,typeof o>"u")if(typeof e=="number")c._orientation=[e,r,a];else return c._orientation;for(var d=c._getSoundIds(o),p=0;p<d.length;p++){var f=c._soundById(d[p]);if(f)if(typeof e=="number")f._orientation=[e,r,a],f._node&&(f._panner||(f._pos||(f._pos=c._pos||[0,0,-.5]),n(f,"spatial")),typeof f._panner.orientationX<"u"?(f._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),f._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),f._panner.orientationZ.setValueAtTime(a,Howler.ctx.currentTime)):f._panner.setOrientation(e,r,a)),c._emit("orientation",f._id);else return f._orientation}return c},Howl.prototype.pannerAttr=function(){var e=this,r=arguments,a,o,c;if(!e._webAudio)return e;if(r.length===0)return e._pannerAttr;if(r.length===1)if(typeof r[0]=="object")a=r[0],typeof o>"u"&&(a.pannerAttr||(a.pannerAttr={coneInnerAngle:a.coneInnerAngle,coneOuterAngle:a.coneOuterAngle,coneOuterGain:a.coneOuterGain,distanceModel:a.distanceModel,maxDistance:a.maxDistance,refDistance:a.refDistance,rolloffFactor:a.rolloffFactor,panningModel:a.panningModel}),e._pannerAttr={coneInnerAngle:typeof a.pannerAttr.coneInnerAngle<"u"?a.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof a.pannerAttr.coneOuterAngle<"u"?a.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof a.pannerAttr.coneOuterGain<"u"?a.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof a.pannerAttr.distanceModel<"u"?a.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof a.pannerAttr.maxDistance<"u"?a.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof a.pannerAttr.refDistance<"u"?a.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof a.pannerAttr.rolloffFactor<"u"?a.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof a.pannerAttr.panningModel<"u"?a.pannerAttr.panningModel:e._panningModel});else return c=e._soundById(parseInt(r[0],10)),c?c._pannerAttr:e._pannerAttr;else r.length===2&&(a=r[0],o=parseInt(r[1],10));for(var d=e._getSoundIds(o),p=0;p<d.length;p++)if(c=e._soundById(d[p]),c){var f=c._pannerAttr;f={coneInnerAngle:typeof a.coneInnerAngle<"u"?a.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:typeof a.coneOuterAngle<"u"?a.coneOuterAngle:f.coneOuterAngle,coneOuterGain:typeof a.coneOuterGain<"u"?a.coneOuterGain:f.coneOuterGain,distanceModel:typeof a.distanceModel<"u"?a.distanceModel:f.distanceModel,maxDistance:typeof a.maxDistance<"u"?a.maxDistance:f.maxDistance,refDistance:typeof a.refDistance<"u"?a.refDistance:f.refDistance,rolloffFactor:typeof a.rolloffFactor<"u"?a.rolloffFactor:f.rolloffFactor,panningModel:typeof a.panningModel<"u"?a.panningModel:f.panningModel};var h=c._panner;h||(c._pos||(c._pos=e._pos||[0,0,-.5]),n(c,"spatial"),h=c._panner),h.coneInnerAngle=f.coneInnerAngle,h.coneOuterAngle=f.coneOuterAngle,h.coneOuterGain=f.coneOuterGain,h.distanceModel=f.distanceModel,h.maxDistance=f.maxDistance,h.refDistance=f.refDistance,h.rolloffFactor=f.rolloffFactor,h.panningModel=f.panningModel}return e},Sound.prototype.init=function(e){return function(){var r=this,a=r._parent;r._orientation=a._orientation,r._stereo=a._stereo,r._pos=a._pos,r._pannerAttr=a._pannerAttr,e.call(this),r._stereo?a.stereo(r._stereo):r._pos&&a.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var r=this,a=r._parent;return r._orientation=a._orientation,r._stereo=a._stereo,r._pos=a._pos,r._pannerAttr=a._pannerAttr,r._stereo?a.stereo(r._stereo):r._pos?a.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,a._refreshBuffer(r)),e.call(this)}}(Sound.prototype.reset);var n=function(e,r){r=r||"spatial",r==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(j);class Os{constructor(){v(this,"music");v(this,"sfx");v(this,"currentMusic",null);v(this,"musicVolume",.7);v(this,"sfxVolume",.8);v(this,"unlocked",!1);this.music=new Map,this.sfx=new Map,this.setupMobileAudioUnlock()}setupMobileAudioUnlock(){if(typeof window>"u")return;const n=()=>{if(this.unlocked)return;const e=new j.Howl({src:["data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA=="],volume:0});e.play(),e.on("end",()=>{e.unload()}),j.Howler.ctx&&j.Howler.ctx.state==="suspended"&&j.Howler.ctx.resume(),this.unlocked=!0,console.log("Audio context unlocked"),document.removeEventListener("touchstart",n),document.removeEventListener("touchend",n),document.removeEventListener("click",n)};document.addEventListener("touchstart",n),document.addEventListener("touchend",n),document.addEventListener("click",n)}loadMusic(n,e){const r=new j.Howl({src:e,loop:!0,volume:this.musicVolume,html5:!0});this.music.set(n,r)}loadSFX(n,e,r){const a=new j.Howl({src:e,volume:this.sfxVolume,sprite:r});this.sfx.set(n,a)}playMusic(n,e=!0){const r=this.music.get(n);if(!r){console.warn(`Music track not found: ${n}`);return}this.currentMusic&&this.currentMusic!==r&&(this.currentMusic.fade(this.musicVolume,0,500),this.currentMusic.once("fade",()=>{this.currentMusic?.stop()})),this.currentMusic=r,e?(r.volume(0),r.play(),r.fade(0,this.musicVolume,1e3)):(r.volume(this.musicVolume),r.play())}stopMusic(n=!0){this.currentMusic&&(n?(this.currentMusic.fade(this.musicVolume,0,500),this.currentMusic.once("fade",()=>{this.currentMusic?.stop(),this.currentMusic=null})):(this.currentMusic.stop(),this.currentMusic=null))}playSFX(n,e){const r=this.sfx.get(n);if(!r){console.warn(`SFX not found: ${n}`);return}e?r.play(e):r.play()}setMusicVolume(n){this.musicVolume=Phaser.Math.Clamp(n,0,1),this.music.forEach(e=>{e.volume(this.musicVolume)})}setSFXVolume(n){this.sfxVolume=Phaser.Math.Clamp(n,0,1),this.sfx.forEach(e=>{e.volume(this.sfxVolume)})}getMusicVolume(){return this.musicVolume}getSFXVolume(){return this.sfxVolume}muteAll(){j.Howler.mute(!0)}unmuteAll(){j.Howler.mute(!1)}destroy(){this.music.forEach(n=>n.unload()),this.sfx.forEach(n=>n.unload()),this.music.clear(),this.sfx.clear(),this.currentMusic=null}}class Ds{constructor(){v(this,"platform","mock");v(this,"initialized",!1);this.detectPlatform()}detectPlatform(){typeof window>"u"||(window.PokiSDK?(this.platform="poki",console.log("AdManager: Poki SDK detected")):window.CrazyGames?(this.platform="crazygames",console.log("AdManager: CrazyGames SDK detected")):(this.platform="mock",console.log("AdManager: Running in mock mode (localhost)")))}async init(){if(!this.initialized)try{this.platform==="poki"?(await window.PokiSDK.init(),console.log("Poki SDK initialized")):this.platform==="crazygames"?(window.CrazyGames.init(),console.log("CrazyGames SDK initialized")):console.log("Mock ad platform initialized"),this.initialized=!0}catch(n){console.error("Failed to initialize ad platform:",n)}}gameLoadingStart(){this.platform==="poki"?window.PokiSDK.gameLoadingStart():this.platform==="mock"&&console.log("[Mock] Game loading started")}gameLoadingFinished(){this.platform==="poki"?window.PokiSDK.gameLoadingFinished():this.platform==="mock"&&console.log("[Mock] Game loading finished")}gameplayStart(){this.platform==="crazygames"?window.CrazyGames.game.gameplayStart():this.platform==="mock"&&console.log("[Mock] Gameplay started")}gameplayStop(){this.platform==="crazygames"?window.CrazyGames.game.gameplayStop():this.platform==="mock"&&console.log("[Mock] Gameplay stopped")}async showInterstitial(){if(console.log("Showing interstitial ad..."),this.platform==="poki")await window.PokiSDK.commercialBreak();else{if(this.platform==="crazygames")return new Promise(n=>{window.CrazyGames.ad.requestAd("midgame",{adFinished:()=>n(),adError:()=>n()})});console.log("[Mock] Showing interstitial ad (2s)"),await new Promise(n=>setTimeout(n,2e3))}console.log("Interstitial ad finished")}async showRewarded(){if(console.log("Showing rewarded ad..."),this.platform==="poki"){const n=await window.PokiSDK.rewardedBreak();return console.log("Rewarded ad finished:",n?"granted":"skipped"),n}else return this.platform==="crazygames"?new Promise(n=>{window.CrazyGames.ad.requestAd("rewarded",{adFinished:()=>n(!0),adError:()=>n(!1)})}):(console.log("[Mock] Showing rewarded ad (2s) - reward granted"),await new Promise(n=>setTimeout(n,2e3)),!0)}happyTime(){this.platform==="crazygames"?window.CrazyGames.game.happytime():this.platform==="mock"&&console.log("[Mock] Happy time!")}getPlatform(){return this.platform}}class Ls{constructor(n){v(this,"scene");v(this,"button");v(this,"isFullscreen",!1);v(this,"isMobile",!1);this.scene=n,this.isMobile="ontouchstart"in window,this.setupFullscreenListeners()}createFullscreenButton(n){const e=n||this.scene,r=2.5,a=10,o=a,c=a,p=e.add.sprite(o,c,"input-prompts",133);p.setScale(r),p.setAlpha(.75),p.setOrigin(0,0),p.setScrollFactor(0),p.setDepth(9998),p.setInteractive({useHandCursor:!0}),p.on("pointerover",()=>{p.setAlpha(1),p.setScale(2.7)}),p.on("pointerout",()=>{p.setAlpha(.75),p.setScale(2.5)}),p.on("pointerdown",()=>{p.setScale(2.3),this.toggleFullscreen()}),p.on("pointerup",()=>{p.setScale(2.5)}),e===this.scene&&(this.button=this.scene.add.container(0,0),this.button.add(p))}setupFullscreenListeners(){document.addEventListener("fullscreenchange",()=>this.onFullscreenChange()),document.addEventListener("webkitfullscreenchange",()=>this.onFullscreenChange()),document.addEventListener("mozfullscreenchange",()=>this.onFullscreenChange()),document.addEventListener("MSFullscreenChange",()=>this.onFullscreenChange())}onFullscreenChange(){this.isFullscreen=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement),this.updateButtonIcon(),console.log("Fullscreen state changed:",this.isFullscreen)}updateButtonIcon(){}toggleFullscreen(){this.isFullscreen?this.exitFullscreen():this.enterFullscreen()}enterFullscreenOnMobile(){this.isMobile&&!this.isFullscreen&&this.enterFullscreen()}enterFullscreen(){const n=this.scene.game.canvas;n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen(),screen.orientation&&"lock"in screen.orientation&&screen.orientation.lock("landscape").catch(()=>{console.log("Orientation lock not supported")})}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}setVisible(n){this.button&&this.button.setVisible(n)}destroy(){this.button&&this.button.destroy(),document.removeEventListener("fullscreenchange",()=>this.onFullscreenChange()),document.removeEventListener("webkitfullscreenchange",()=>this.onFullscreenChange()),document.removeEventListener("mozfullscreenchange",()=>this.onFullscreenChange()),document.removeEventListener("MSFullscreenChange",()=>this.onFullscreenChange())}}window.pako=gs;class Rs extends C.Scene{constructor(){super({key:"BootScene"});v(this,"inputMapper");v(this,"audioManager");v(this,"adManager");v(this,"fullscreenManager")}create(){console.log("BootScene: Initializing systems..."),this.inputMapper=new Cs(this),this.audioManager=new Os,this.adManager=new Ds,this.fullscreenManager=new Ls(this),this.registry.set("inputMapper",this.inputMapper),this.registry.set("audioManager",this.audioManager),this.registry.set("adManager",this.adManager),this.registry.set("fullscreenManager",this.fullscreenManager),this.adManager.init().then(()=>{this.adManager.gameLoadingStart()}),console.log("BootScene: Systems initialized"),this.scene.start("PreloadScene")}}class zs extends C.Scene{constructor(){super({key:"PreloadScene"});v(this,"progressBar");v(this,"progressBox");v(this,"loadingText");v(this,"percentText")}preload(){this.createLoadingScreen(),this.load.on("progress",this.onProgress,this),this.load.on("complete",this.onComplete,this),this.load.spritesheet("input-prompts","assets/input-prompts.png",{frameWidth:16,frameHeight:16,spacing:1,margin:0}),this.load.tilemapTiledJSON("promenade-map","assets/maps/promenade.json"),this.load.image("promenade-tileset","assets/maps/assets/promenade.png"),this.load.image("mountains","assets/maps/assets/mountains.png"),this.load.image("buildings","assets/maps/assets/buildings.png"),this.load.image("playable-area","assets/maps/assets/playable-area.png"),this.load.image("parallax-background","assets/maps/assets/parallax_background_layer_6.png"),this.load.image("character-south","assets/character-athlone/rotations/south.png"),this.load.image("character-west","assets/character-athlone/rotations/west.png"),this.load.image("character-east","assets/character-athlone/rotations/east.png"),this.load.image("character-north","assets/character-athlone/rotations/north.png"),this.load.image("street-lamp","assets/street-lamp.png"),this.load.image("gym-equipment","assets/gym-equipment.png"),this.load.image("trash-bin","assets/trash-bin.png")}createLoadingScreen(){const e=Q,r=G;this.loadingText=this.add.text(e/2,r/2-50,"Loading...",{fontFamily:"Arial",fontSize:"20px",color:"#ffffff"}),this.loadingText.setOrigin(.5),this.percentText=this.add.text(e/2,r/2,"0%",{fontFamily:"Arial",fontSize:"18px",color:"#ffffff"}),this.percentText.setOrigin(.5),this.progressBox=this.add.graphics(),this.progressBox.fillStyle(2236962,.8),this.progressBox.fillRect(e/2-160,r/2+20,320,30),this.progressBar=this.add.graphics()}onProgress(e){this.percentText.setText(Math.floor(e*100)+"%"),this.progressBar.clear(),this.progressBar.fillStyle(65280,1),this.progressBar.fillRect(Q/2-155,G/2+25,310*e,20)}onComplete(){this.progressBar.destroy(),this.progressBox.destroy(),this.loadingText.destroy(),this.percentText.destroy();const e=this.registry.get("adManager");e&&e.gameLoadingFinished(),console.log("PreloadScene: Assets loaded"),this.time.delayedCall(500,()=>{this.scene.start("MainMenuScene")})}}class Bs extends C.Scene{constructor(){super({key:"MainMenuScene"});v(this,"inputMapper");v(this,"fullscreenManager");v(this,"titleText");v(this,"playButton");v(this,"creditsText")}create(){this.inputMapper=this.registry.get("inputMapper"),this.fullscreenManager=this.registry.get("fullscreenManager"),this.inputMapper.setScene(this),this.fullscreenManager&&this.fullscreenManager.createFullscreenButton(this),this.titleText=this.add.text(Q/2,G/3,"GATSBY GUARDIANS",{fontFamily:"Arial Black",fontSize:"32px",color:"#00ff00",stroke:"#000000",strokeThickness:6}),this.titleText.setOrigin(.5);const e=this.fullscreenManager.isMobile?"TAP TO PLAY":"PRESS SPACE TO PLAY";this.playButton=this.add.text(Q/2,G/2,e,{fontFamily:"Arial",fontSize:"20px",color:"#ffffff"}),this.playButton.setOrigin(.5),this.playButton.setInteractive({useHandCursor:!0}),this.playButton.on("pointerover",()=>{this.playButton.setColor("#00ff00")}),this.playButton.on("pointerout",()=>{this.playButton.setColor("#ffffff")}),this.playButton.on("pointerdown",()=>{this.startGame()}),this.tweens.add({targets:this.playButton,alpha:.3,duration:800,yoyo:!0,repeat:-1}),this.creditsText=this.add.text(Q/2,G-30,"A Retro Platformer Game",{fontFamily:"Arial",fontSize:"12px",color:"#888888"}),this.creditsText.setOrigin(.5),console.log("MainMenuScene: Ready")}update(){this.inputMapper&&(this.inputMapper.update(),this.inputMapper.isActionJustPressed(Bt.JUMP)&&this.startGame())}startGame(){console.log("Starting game..."),this.fullscreenManager&&this.fullscreenManager.enterFullscreenOnMobile(),this.tweens.killTweensOf(this.playButton),console.log("Transitioning to PromenadeScene..."),this.scene.start("PromenadeScene")}}var nt=(t=>(t.SOGGY="soggy",t))(nt||{});class Hs{constructor(n){v(this,"config");v(this,"remainingFrames");v(this,"target",null);this.config=n,this.remainingFrames=n.duration}apply(n){this.target=n,this.onApply()}update(){this.remainingFrames>0&&this.remainingFrames--,this.onUpdate()}remove(){this.onRemove(),this.target=null}hasExpired(){return this.config.duration!==-1&&this.remainingFrames<=0}getType(){return this.config.type}}class Ks extends Hs{constructor(e=300){const r={type:nt.SOGGY,duration:e};super(r);v(this,"SPEED_MULTIPLIER",1.5);v(this,"DAMAGE_MULTIPLIER",2);v(this,"originalSpeed",Mn)}onApply(){this.target&&(this.originalSpeed=this.target.getSpeed(),this.target.setSpeed(this.originalSpeed*this.SPEED_MULTIPLIER),this.target.setTint(8947967),console.log("Soggy effect applied! Speed increased, damage vulnerability doubled."))}onUpdate(){}onRemove(){this.target&&(this.target.setSpeed(this.originalSpeed),this.target.clearTint(),console.log("Soggy effect removed."))}getDamageMultiplier(){return this.DAMAGE_MULTIPLIER}}class Ns extends C.Physics.Arcade.Sprite{constructor(e,r,a,o){super(e,r,a,"character-west");v(this,"inputMapper");v(this,"weaponManager");v(this,"statusEffectManager");v(this,"coyoteFrames",0);v(this,"jumpBufferFrames",0);v(this,"currentSpeed",Mn);if(this.inputMapper=o,this.weaponManager=e.registry.get("weaponManager"),this.statusEffectManager=e.registry.get("statusEffectManager"),e.add.existing(this),e.physics.add.existing(this),this.weaponManager&&this.weaponManager.setOwner(this),this.statusEffectManager&&this.statusEffectManager.setTarget(this),this.body){const c=this.body;c.setCollideWorldBounds(!0);const d=14,p=34;c.setSize(d,p);const f=(this.width-d)/2,h=this.height-p-7;c.setOffset(f,h)}this.setOrigin(.5,.5)}update(e,r){if(!this.body)return;const a=this.body;this.weaponManager&&this.weaponManager.update(),this.statusEffectManager&&this.statusEffectManager.update(),a.onFloor()?this.coyoteFrames=Ti:this.coyoteFrames>0&&this.coyoteFrames--;const o=this.coyoteFrames>0;this.inputMapper.isActionJustPressed(Bt.JUMP)&&(o?this.jump():this.jumpBufferFrames=Mi),this.jumpBufferFrames>0&&(o?(this.jump(),this.jumpBufferFrames=0):this.jumpBufferFrames--);const c=this.inputMapper.getAxis();c.x!==0?(a.setVelocityX(c.x*this.currentSpeed),c.x<0?this.setFlipX(!1):c.x>0&&this.setFlipX(!0)):(a.setVelocityX(a.velocity.x*.9),Math.abs(a.velocity.x)<1&&a.setVelocityX(0)),this.x=Math.round(this.x),this.y=Math.round(this.y),this.handleWeaponInput(),this.updateAnimation()}handleWeaponInput(){if(!this.weaponManager)return;const e=this.inputMapper.getInputState();if(e.weaponNext&&this.weaponManager.nextWeapon(),e.weaponPrevious&&this.weaponManager.previousWeapon(),e.primaryFireJustPressed||e.primaryFire){const r={x:this.flipX?-1:1,y:0};this.weaponManager.fire(r)}}jump(){if(!this.body)return;this.body.setVelocityY(Ei),this.coyoteFrames=0}updateAnimation(){this.body}takeDamage(e){let r=e;if(this.statusEffectManager){const a=this.statusEffectManager.getEffect(nt.SOGGY);a&&(r*=a.getDamageMultiplier())}console.log(`Player took ${r} damage (base: ${e})`),this.setTint(16711680),this.scene.time.delayedCall(100,()=>{!this.statusEffectManager||!this.statusEffectManager.hasEffect(nt.SOGGY)?this.clearTint():this.setTint(8947967)})}applySoggy(e=300){if(!this.statusEffectManager)return;const r=new Ks(e);this.statusEffectManager.applyEffect(r)}getSpeed(){return this.currentSpeed}setSpeed(e){this.currentSpeed=e}reset(e,r){this.setPosition(e,r),this.body&&this.body.setVelocity(0,0),this.clearTint(),this.coyoteFrames=0,this.jumpBufferFrames=0}}class Zs{constructor(n,e=!0){v(this,"scene");v(this,"enabled",!1);v(this,"indicatorText");v(this,"buttonContainer");v(this,"sceneMap",new Map([[1,"PromenadeScene"]]));this.scene=n,this.enabled=e,this.enabled&&(this.setupKeyboardShortcuts(),this.createButtons())}setupKeyboardShortcuts(){const n={1:C.Input.Keyboard.KeyCodes.ONE,2:C.Input.Keyboard.KeyCodes.TWO,3:C.Input.Keyboard.KeyCodes.THREE,4:C.Input.Keyboard.KeyCodes.FOUR};this.sceneMap.forEach((a,o)=>{const c=n[o];if(c){const d=this.scene.input.keyboard?.addKey(c);d&&d.on("down",()=>this.switchToScene(a))}});const e=this.scene.input.keyboard?.addKey(C.Input.Keyboard.KeyCodes.ESC);e&&e.on("down",()=>this.switchToScene("MainMenuScene"));const r=this.scene.input.keyboard?.addKey(C.Input.Keyboard.KeyCodes.BACKTICK);r&&r.on("down",()=>this.toggleIndicator())}createButtons(){this.buttonContainer=this.scene.add.container(0,0),this.buttonContainer.setScrollFactor(0),this.buttonContainer.setDepth(9997);const e=16*2.5,r=10,a=e+8,o=this.scene.cameras.main.width-e-r,c=r,d={one:51,esc:17};this.createSceneButton(o,c,d.esc,"MainMenuScene","ESC: Menu"),this.createSceneButton(o-a,c,d.one,"PromenadeScene","1: Promenade")}createSceneButton(n,e,r,a,o){const c=this.scene.add.sprite(n,e,"input-prompts",r);c.setScale(2.5),c.setAlpha(.75),c.setOrigin(0,0),c.setInteractive({useHandCursor:!0}),c.on("pointerover",()=>{c.setAlpha(1),c.setScale(2.7)}),c.on("pointerout",()=>{c.setAlpha(.75),c.setScale(2.5)}),c.on("pointerdown",()=>{c.setScale(2.3),this.switchToScene(a)}),c.on("pointerup",()=>{c.setScale(2.5)}),this.buttonContainer?.add(c)}toggleIndicator(){this.buttonContainer&&this.buttonContainer.setVisible(!this.buttonContainer.visible)}switchToScene(n){console.log(`SceneSwitcher: Switching to ${n}`),this.showTransitionFeedback(n),this.scene.time.delayedCall(100,()=>{this.scene.scene.start(n)})}showTransitionFeedback(n){const e=this.scene.add.text(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,`Switching to ${n}...`,{fontFamily:"Arial",fontSize:"16px",color:"#ffffff",backgroundColor:"#000000",padding:{x:10,y:6}});e.setOrigin(.5),e.setScrollFactor(0),e.setDepth(10001),this.scene.tweens.add({targets:e,alpha:0,duration:300,onComplete:()=>e.destroy()})}setEnabled(n){this.enabled=n,this.indicatorText&&this.indicatorText.setVisible(n)}destroy(){this.indicatorText&&this.indicatorText.destroy(),this.buttonContainer&&this.buttonContainer.destroy()}}var B=(t=>(t.POLONY_PUMMELER="polonypummeler",t.CHIP_SHOTGUN="chipshotgun",t.CALAMARI_WHIP="calamariwhip",t.MASALA_FLAMER="masalaflamer",t))(B||{});class st{constructor(n,e){v(this,"scene");v(this,"config");v(this,"cooldownFrames",0);v(this,"owner",null);this.scene=n,this.config=e}setOwner(n){this.owner=n}update(){this.cooldownFrames>0&&this.cooldownFrames--}fire(n){return this.cooldownFrames>0||!this.owner?!1:(this.onFire(n),this.cooldownFrames=this.config.fireRate,!0)}canFire(){return this.cooldownFrames===0&&this.owner!==null}getType(){return this.config.type}getName(){return this.config.name}getConfig(){return this.config}}class $s extends st{constructor(e){const r={type:B.POLONY_PUMMELER,name:"Polony Pummeler",fireRate:15,damage:10,saturationPerHit:5,range:24};super(e,r);v(this,"hitbox",null)}onFire(e){if(!this.owner)return;const r=this.owner.x+e.x*this.config.range,a=this.owner.y;this.hitbox=this.scene.add.zone(r,a,20,24),this.scene.physics.add.existing(this.hitbox),this.scene.time.delayedCall(50,()=>{this.hitbox&&(this.hitbox.destroy(),this.hitbox=null)}),console.log(`Polony Pummeler swing at (${r}, ${a})`)}getHitbox(){return this.hitbox}destroy(){this.hitbox&&(this.hitbox.destroy(),this.hitbox=null)}}class Us extends C.Physics.Arcade.Sprite{constructor(e,r,a){const o=e.add.graphics();o.fillStyle(16776960,1),o.fillRect(0,0,8,8),o.generateTexture("projectile-placeholder",8,8),o.destroy();super(e,r,a,"projectile-placeholder");v(this,"lifetimeFrames",0);v(this,"_damage",0);v(this,"_saturation",0);e.add.existing(this),e.physics.add.existing(this)}launch(e,r,a,o){this.setPosition(e,r),this.setActive(!0),this.setVisible(!0);const c=this.body;c.setVelocity(a.x,a.y),c.setAllowGravity(!1),this._damage=o.damage,this._saturation=o.saturation,this.lifetimeFrames=o.lifetime}update(){if(!this.active)return;this.lifetimeFrames--,this.lifetimeFrames<=0&&this.deactivate();const e=this.body;e&&(this.rotation=Math.atan2(e.velocity.y,e.velocity.x))}deactivate(){this.setActive(!1),this.setVisible(!1);const e=this.body;e&&e.setVelocity(0,0)}getDamage(){return this._damage}getSaturation(){return this._saturation}}class Gs{constructor(n,e,r=50){v(this,"pool");this.pool=n.add.group({classType:e,maxSize:r,runChildUpdate:!1})}get(){const n=this.pool.get();return n&&(n.setActive(!0),n.setVisible(!0)),n}release(n){"setActive"in n&&n.setActive(!1),"setVisible"in n&&n.setVisible(!1),this.pool.killAndHide(n)}getGroup(){return this.pool}clear(){this.pool.clear(!0,!0)}}class Vs extends st{constructor(e){const r={type:B.CHIP_SHOTGUN,name:"Chip Shotgun",fireRate:30,damage:5,saturationPerHit:3,projectileSpeed:200};super(e,r);v(this,"projectilePool");v(this,"projectiles",new Set);this.projectilePool=new Gs(e,Us,30)}onFire(e){if(!this.owner)return;const r=[-15,0,15],a=Math.atan2(e.y,e.x);r.forEach(o=>{const c=a+o*Math.PI/180,d={x:Math.cos(c)*this.config.projectileSpeed,y:Math.sin(c)*this.config.projectileSpeed},p=this.projectilePool.get();if(p){const f={sprite:"chip-projectile",speed:this.config.projectileSpeed,damage:this.config.damage,saturation:this.config.saturationPerHit,lifetime:120};p.launch(this.owner.x,this.owner.y,d,f),this.projectiles.add(p)}}),console.log("Chip Shotgun fired 3 projectiles in spread pattern")}update(){super.update(),this.projectiles.forEach(e=>{e.active?e.update():(this.projectiles.delete(e),this.projectilePool.release(e))})}getProjectileGroup(){return this.projectilePool.getGroup()}destroy(){this.projectiles.forEach(e=>this.projectilePool.release(e)),this.projectiles.clear(),this.projectilePool.clear()}}class Xs extends st{constructor(e){const r={type:B.CALAMARI_WHIP,name:"Calamari Whip",fireRate:45,damage:3,saturationPerHit:2,range:150};super(e,r);v(this,"whipLine",null)}onFire(e){if(!this.owner)return;const r=this.owner.x+e.x*this.config.range,a=this.owner.y+e.y*this.config.range;this.whipLine=this.scene.add.line(0,0,this.owner.x,this.owner.y,r,a,16777215),this.whipLine.setOrigin(0,0),this.whipLine.setLineWidth(2),console.log(`Calamari Whip extends to (${r}, ${a})`),this.scene.time.delayedCall(166,()=>{this.whipLine&&(this.whipLine.destroy(),this.whipLine=null)})}getWhipLine(){return this.whipLine}destroy(){this.whipLine&&(this.whipLine.destroy(),this.whipLine=null)}}class Ys extends st{constructor(e){const r={type:B.MASALA_FLAMER,name:"Masala Flamer",fireRate:2,damage:1,saturationPerHit:.5,range:80};super(e,r);v(this,"flameCone",null);v(this,"isFiring",!1)}onFire(e){if(!this.owner)return;if(this.isFiring=!0,!this.flameCone){const a=this.config.range;this.flameCone=this.scene.add.triangle(this.owner.x,this.owner.y,0,0,a,-20,a,20,16737792,.6)}this.flameCone.setPosition(this.owner.x,this.owner.y);const r=Math.atan2(e.y,e.x);this.flameCone.setRotation(r),console.log("Masala Flamer firing continuously")}stopFiring(){this.isFiring=!1,this.flameCone&&(this.flameCone.destroy(),this.flameCone=null)}update(){super.update(),!this.isFiring&&this.flameCone&&(this.flameCone.destroy(),this.flameCone=null)}getFlameCone(){return this.flameCone}destroy(){this.flameCone&&(this.flameCone.destroy(),this.flameCone=null)}}class Ws{constructor(n){v(this,"weapons");v(this,"currentWeapon");v(this,"weaponOrder",[B.POLONY_PUMMELER,B.CHIP_SHOTGUN,B.CALAMARI_WHIP,B.MASALA_FLAMER]);v(this,"currentIndex",0);this.weapons=new Map,this.weapons.set(B.POLONY_PUMMELER,new $s(n)),this.weapons.set(B.CHIP_SHOTGUN,new Vs(n)),this.weapons.set(B.CALAMARI_WHIP,new Xs(n)),this.weapons.set(B.MASALA_FLAMER,new Ys(n)),this.currentWeapon=this.weapons.get(this.weaponOrder[0])}setOwner(n){this.weapons.forEach(e=>e.setOwner(n))}update(){this.weapons.forEach(n=>n.update())}nextWeapon(){this.currentIndex=(this.currentIndex+1)%this.weaponOrder.length,this.currentWeapon=this.weapons.get(this.weaponOrder[this.currentIndex]),console.log(`Switched to: ${this.currentWeapon.getName()}`)}previousWeapon(){this.currentIndex=(this.currentIndex-1+this.weaponOrder.length)%this.weaponOrder.length,this.currentWeapon=this.weapons.get(this.weaponOrder[this.currentIndex]),console.log(`Switched to: ${this.currentWeapon.getName()}`)}fire(n){return this.currentWeapon.fire(n)}getCurrentWeapon(){return this.currentWeapon}getWeapon(n){return this.weapons.get(n)}setScene(n){}destroy(){this.weapons.forEach(n=>n.destroy()),this.weapons.clear()}}class js{constructor(n){v(this,"activeEffects");v(this,"target",null);this.activeEffects=new Map}setTarget(n){this.target=n}applyEffect(n){if(!this.target)return;const e=n.getType();this.activeEffects.has(e)&&this.removeEffect(e),n.apply(this.target),this.activeEffects.set(e,n)}removeEffect(n){const e=this.activeEffects.get(n);e&&(e.remove(),this.activeEffects.delete(n))}update(){const n=[];this.activeEffects.forEach((e,r)=>{e.update(),e.hasExpired()&&n.push(r)}),n.forEach(e=>this.removeEffect(e))}hasEffect(n){return this.activeEffects.has(n)}getEffect(n){return this.activeEffects.get(n)}clearAll(){this.activeEffects.forEach(n=>n.remove()),this.activeEffects.clear()}setScene(n){}destroy(){this.clearAll()}}class Js extends C.Scene{constructor(){super({key:"PromenadeScene"});v(this,"inputMapper");v(this,"weaponManager");v(this,"statusEffectManager");v(this,"fullscreenManager");v(this,"player");v(this,"platformsLayer");v(this,"map");v(this,"tileset");v(this,"spawnPoint",null);v(this,"levelWidth",0);v(this,"levelHeight",0)}create(){console.log("PromenadeScene: Starting Sea Point Promenade level..."),this.inputMapper=this.registry.get("inputMapper"),this.fullscreenManager=this.registry.get("fullscreenManager"),this.weaponManager=new Ws(this),this.statusEffectManager=new js(this),this.registry.set("weaponManager",this.weaponManager),this.registry.set("statusEffectManager",this.statusEffectManager),this.inputMapper.setScene(this),this.fullscreenManager&&this.fullscreenManager.createFullscreenButton(this),this.loadTiledMap(),this.createPlayer(),this.cameras.main.setBounds(0,0,this.levelWidth,this.levelHeight),this.cameras.main.startFollow(this.player,!0,.08,.08),this.physics.world.setBounds(0,0,this.levelWidth,this.levelHeight),new Zs(this,Pi),console.log(`PromenadeScene: Level ready - ${this.levelWidth}x${this.levelHeight}px`)}loadTiledMap(){this.map=this.make.tilemap({key:"promenade-map"}),this.levelWidth=this.map.widthInPixels,this.levelHeight=this.map.heightInPixels;const e=this.map.addTilesetImage("EmbeddedPromenade","promenade-tileset",16,16,1,2);if(!e){console.error("PromenadeScene: Failed to load tileset");return}this.tileset=e;const r=["world","middleground","foreground"];for(const a of r)try{const o=this.map.createLayer(a,this.tileset);if(o){console.log(`PromenadeScene: Created tile layer '${a}'`);const c=this.map.getLayer(a);if(c?.properties){const d=c.properties,p=d.find(h=>h.name==="depth");p&&o.setDepth(p.value);const f=d.find(h=>h.name==="scrollFactorX");f&&o.setScrollFactor(f.value,0)}(a==="world"||a==="platforms")&&(this.platformsLayer=o,o.setCollisionByProperty({collides:!0}),console.log(`PromenadeScene: Enabled tile collision on '${a}' layer (collides property)`))}else console.log(`PromenadeScene: Layer '${a}' not found in map`)}catch(o){console.error(`PromenadeScene: Error creating layer '${a}':`,o)}console.log("PromenadeScene: Processed tile layers"),this.createImageLayers(),this.processObjectLayer()}createImageLayers(){const r=this.cache.tilemap.get("promenade-map")?.data;r?.layers&&r.layers.forEach(a=>{if(a.type!=="imagelayer")return;if(a.visible===!1){console.log(`PromenadeScene: Skipping hidden image layer '${a.name}'`);return}let o=0,c=1;if(a.properties){const p=a.properties.find(h=>h.name==="depth");p&&(o=p.value);const f=a.properties.find(h=>h.name==="scrollFactorX");f&&(c=f.value)}let d="parallax-background";if(a.image){const p=a.image.split(/[/\\]/),h=p[p.length-1].split(".");h.length>0&&(d=h[0])}if(console.log(`PromenadeScene: Processing image layer '${a.name}' with texture '${d}'`),a.repeatx){const p=this.add.tileSprite(0,a.y||0,this.levelWidth,G,d);p.setOrigin(0,0),p.setScrollFactor(c,0),p.setDepth(o),console.log(`PromenadeScene: Created repeating image layer '${a.name}' at depth ${o}`)}else{const p=this.add.image(a.x||0,a.y||0,d);p.setOrigin(0,0),p.setScrollFactor(c,0),p.setDepth(o),console.log(`PromenadeScene: Created image layer '${a.name}' at depth ${o}`)}})}processObjectLayer(){const e=this.map.getObjectLayer("objects");if(!e){console.warn("PromenadeScene: No objects layer found");return}e.objects.forEach(r=>{const o=r.properties?.find(c=>c.name==="type")?.value||"";switch(o){case"player-spawn":this.spawnPoint={x:r.x||0,y:r.y||0},console.log(`PromenadeScene: Found spawn point at (${this.spawnPoint.x}, ${this.spawnPoint.y})`);break;case"dustbin":console.log(`PromenadeScene: Found dustbin at (${r.x}, ${r.y})`);break;default:o&&o!=="ground"&&o!=="platform"&&console.log(`PromenadeScene: Object '${r.name}' type='${o}' at (${r.x}, ${r.y})`)}})}createPlayer(){const e=this.spawnPoint||{x:36,y:208};this.spawnPoint||console.warn("PromenadeScene: No spawn point found in map, using default (36, 208)"),this.player=new Ns(this,e.x,e.y,this.inputMapper),this.platformsLayer&&this.physics.add.collider(this.player,this.platformsLayer),this.player.setCollideWorldBounds(!0),console.log(`PromenadeScene: Player spawned at (${e.x}, ${e.y})`)}update(e,r){this.inputMapper.update(),this.player.update(e,r)}}const qs={type:C.WEBGL,parent:"game-container",width:Q,height:G,pixelArt:!0,roundPixels:!0,antialias:!1,backgroundColor:"#000000",input:{keyboard:!0,mouse:!0,touch:!0,gamepad:!1},scale:{mode:C.Scale.NONE,autoCenter:C.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{y:ki,x:0},debug:!1}},scene:[Rs,zs,Bs,Js],fps:{target:60,forceSetTimeOut:!1},render:{pixelArt:!0,antialias:!1,antialiasGL:!1,roundPixels:!0}};class Qs{constructor(n){v(this,"game");this.game=n,this.setupScaling(),this.setupResizeListener()}setupScaling(){this.updateScale()}setupResizeListener(){window.addEventListener("resize",()=>{this.updateScale()})}updateScale(){const n=Math.floor(window.innerWidth/Q),e=Math.floor(window.innerHeight/G),r=Math.max(1,Math.min(n,e)),a=Q*r,o=G*r;this.game.scale.resize(Q,G);const c=this.game.canvas;c&&(c.style.width=`${a}px`,c.style.height=`${o}px`,c.style.display="block",c.style.margin="0 auto")}forceUpdate(){this.updateScale()}}const xi=new C.Game(qs),eo=new Qs(xi);window.game=xi;window.scaleManager=eo;console.log("Gatsby Guardians - Game initialized");
